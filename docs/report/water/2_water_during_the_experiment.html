<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>3&nbsp; Use of water during the experiment ‚Äì PhD soybean 2021-2024</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../report/physio/2_RUE.html" rel="next">
<link href="../../report/intro/1_experimental_design_climat.html" rel="prev">
<link href="../../src/root.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script src="../../site_libs/quarto-contrib/iconify-2.1.0/iconify-icon.min.js"></script>
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../../site_libs/kePrint-0.0.1/kePrint.js"></script>

<link href="../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">



</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../report/water/2_water_during_the_experiment.html"><strong>üå± Ecophysiology</strong></a></li><li class="breadcrumb-item"><a href="../../report/water/2_water_during_the_experiment.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Use of water during the experiment</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../../index.html" class="sidebar-logo-link">
      <img src="../../src/root.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">PhD soybean 2021-2024</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/cmaslard/phd_soybean_2021_2024/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="../../guide-R.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
    <div id="quarto-search" class="quarto-navigation-tool px-1" title="Search"></div>
</div>
    </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text"><strong>Introduction to the thesis</strong></span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../report/intro/intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../report/intro/1_experimental_design_climat.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Experimental design and climate condition</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text"><strong>üå± Ecophysiology</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../report/water/2_water_during_the_experiment.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Use of water during the experiment</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../report/physio/2_RUE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Calcul of Radiation Use Efficiency</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../report/physio/0_preprocessing_ecophy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Pre-processing of ecophysiological data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../report/physio/2_rapid_analysis_ecophy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Rapid analysis of ecophysiological data</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text"><strong>ü´ö Root architecture</strong></span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../report/root_architecture/0_preprocessing_root_architecture.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Pre-processing of root architecture data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../report/root_architecture/2_rapid_analysis_root_architecture.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Rapid analysis of root architecture data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../report/root_architecture/2_root_architecturedepending_depth.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Analyse Root Architecture dependent of the depth</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text"><strong>‚öõÔ∏è Ionomics</strong></span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../report/iono/0A_preprocessing_iono.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Pre-processing of ionomic data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../report/iono/0B_preprocessing_efficiency.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Pre-processing for efficiency in ionomic analyse</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../report/iono/2_rapid_analysis_iono.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Analysis of ionome</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text"><strong>üìä Multi-Omics Integration</strong></span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../report/multi_omics/A1_physio_iono_RA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Root architecture - Ionomics - Biomass - Water - Licor</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#data-importation" id="toc-data-importation" class="nav-link active" data-scroll-target="#data-importation"><span class="header-section-number">3.1</span> Data importation</a></li>
  <li><a href="#water-in-the-rhizotube" id="toc-water-in-the-rhizotube" class="nav-link" data-scroll-target="#water-in-the-rhizotube"><span class="header-section-number">3.2</span> Water in the rhizotube</a></li>
  <li><a href="#evapotranspiration" id="toc-evapotranspiration" class="nav-link" data-scroll-target="#evapotranspiration"><span class="header-section-number">3.3</span> Evapotranspiration</a>
  <ul class="collapse">
  <li><a href="#kinetics" id="toc-kinetics" class="nav-link" data-scroll-target="#kinetics"><span class="header-section-number">3.3.1</span> Kinetics</a></li>
  <li><a href="#total-evapotranspiration" id="toc-total-evapotranspiration" class="nav-link" data-scroll-target="#total-evapotranspiration"><span class="header-section-number">3.3.2</span> Total evapotranspiration</a></li>
  </ul></li>
  <li><a href="#wue-and-srwu" id="toc-wue-and-srwu" class="nav-link" data-scroll-target="#wue-and-srwu"><span class="header-section-number">3.4</span> WUE and sRWU</a>
  <ul class="collapse">
  <li><a href="#wue-with-mean-in-h1-and-h2" id="toc-wue-with-mean-in-h1-and-h2" class="nav-link" data-scroll-target="#wue-with-mean-in-h1-and-h2"><span class="header-section-number">3.4.1</span> WUE with mean in H1 and H2</a></li>
  <li><a href="#wue-and-srwu-h1-mean" id="toc-wue-and-srwu-h1-mean" class="nav-link" data-scroll-target="#wue-and-srwu-h1-mean"><span class="header-section-number">3.4.2</span> WUE and sRWU (H1 mean )</a></li>
  <li><a href="#wue-and-srwu-drawing-with-discount" id="toc-wue-and-srwu-drawing-with-discount" class="nav-link" data-scroll-target="#wue-and-srwu-drawing-with-discount"><span class="header-section-number">3.4.3</span> WUE and sRWU (Drawing with discount )</a></li>
  </ul></li>
  <li><a href="#evapo-surface" id="toc-evapo-surface" class="nav-link" data-scroll-target="#evapo-surface"><span class="header-section-number">3.5</span> Evapo / Surface</a></li>
  <li><a href="#evaporation-one-days-befor-second-harvest" id="toc-evaporation-one-days-befor-second-harvest" class="nav-link" data-scroll-target="#evaporation-one-days-befor-second-harvest"><span class="header-section-number">3.6</span> Evaporation one days befor second harvest</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/cmaslard/phd_soybean_2021_2024/blob/main/report/water/2_water_during_the_experiment.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li><li><a href="https://github.com/cmaslard/phd_soybean_2021_2024/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../report/water/2_water_during_the_experiment.html"><strong>üå± Ecophysiology</strong></a></li><li class="breadcrumb-item"><a href="../../report/water/2_water_during_the_experiment.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Use of water during the experiment</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-physio" class="quarto-section-identifier"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Use of water during the experiment</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pkg </span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car) </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rmisc) </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multcomp) </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(hms)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tictoc)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multcompView)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstatix)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="co">#function</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"src/function/graph_function.R"</span>)) <span class="co"># i woud like to delet it</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"src/function/stat_function/stat_analysis_main.R"</span>)) <span class="co"># for make plot </span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="co"># cosmetics</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>climate_pallet<span class="ot">=</span><span class="fu">read_excel</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/color_palette.xlsm"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(set <span class="sc">==</span> <span class="st">"climat_condition"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">select</span>(color, treatment) <span class="sc">%&gt;%</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>      <span class="fu">pull</span>(color) <span class="sc">%&gt;%</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>      <span class="fu">setNames</span>(<span class="fu">read_excel</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/color_palette.xlsm"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">filter</span>(set <span class="sc">==</span> <span class="st">"climat_condition"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">pull</span>(treatment)</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>               )</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="co"># variable</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="data-importation" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="data-importation"><span class="header-section-number">3.1</span> Data importation</h2>
<ul>
<li>Import information about the rhizotube (type of stress, harvest date, ‚Ä¶). But only the odd plant.</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>plant_info<span class="ot">=</span><span class="fu">read_excel</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/plant_information.xlsx"</span>))</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>plant_info_impaire<span class="ot">=</span> plant_info <span class="sc">%&gt;%</span> <span class="fu">filter</span>(paire<span class="sc">==</span><span class="st">"FALSE"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li>Import and compile raw watering and raw weighing data from the experiment</li>
<li>Warning, I have added the manual values realized on October 8, 2021.</li>
<li>Correction of the weights, <em>According to the weight of the soil, the weight of the empty rhizotubes, the weight of the stakes and the mini-greenhouse</em></li>
<li>Import of substrate moisture data prior to the experiment and stake weights</li>
<li>Subtract or add the weight of each the Rhizotube, mini greenhouses or stake</li>
<li>Adding the weight of the mini greenhouses taking into account the date of presence of the mini greenhouses (given in the excel) First step, remove the inistial points from the rhizotube and add the fresh soil and dry soil data</li>
<li>Removed or added the weight corresponding to the minigreenhouse or the stake</li>
<li>Select the desired time interval (start and end of experiment) and delete the outliers</li>
<li>Add the information for each rhizotube (WS WW, HS, OT, genotype, date of harvest‚Ä¶)</li>
<li>Save the intermediate results</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Weighing</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>files_name<span class="ot">=</span><span class="fu">list.files</span>(<span class="at">path =</span>here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/water/weighing"</span>), <span class="at">pattern =</span> (<span class="st">".csv$"</span>))</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>first_data<span class="ot">=</span><span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="fu">paste0</span>(<span class="st">"data/water/weighing/"</span>,files_name[<span class="dv">1</span>])), <span class="at">sep=</span><span class="st">";"</span>) ; <span class="fu">colnames</span>(first_data)<span class="ot">=</span><span class="fu">colnames</span>(first_data[<span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(first_data)])</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>first_data<span class="ot">=</span>first_data[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(first_data)<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>data_global_weighing<span class="ot">=</span><span class="fu">matrix</span>(<span class="at">data=</span><span class="cn">NA</span>, <span class="at">ncol=</span><span class="fu">length</span>(first_data),<span class="at">nrow =</span> <span class="dv">0</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(data_global_weighing)<span class="ot">=</span><span class="fu">colnames</span>(first_data)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(file <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(files_name)){</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  first_data<span class="ot">=</span><span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="fu">paste0</span>(<span class="st">"data/water/weighing/"</span>,files_name[file])), <span class="at">sep=</span><span class="st">";"</span>)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(first_data)<span class="ot">=</span><span class="fu">colnames</span>(first_data[<span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(first_data)])</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  first_data<span class="ot">=</span>first_data[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(first_data)<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  data_global_weighing<span class="ot">=</span><span class="fu">rbind</span>(data_global_weighing,first_data)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>data_global_weighing<span class="sc">$</span>deliveredquantity<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="co">#Watering</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>files_name<span class="ot">=</span><span class="fu">list.files</span>(<span class="at">path =</span>here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/water/watering"</span>), <span class="at">pattern =</span> (<span class="st">".csv$"</span>))</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>first_data<span class="ot">=</span><span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="fu">paste0</span>(<span class="st">"data/water/watering/"</span>),files_name[<span class="dv">1</span>]), <span class="at">sep=</span><span class="st">";"</span>)</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(first_data)<span class="ot">=</span><span class="fu">colnames</span>(first_data[<span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(first_data)])</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>first_data<span class="ot">=</span>first_data[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(first_data)<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>data_global_watering<span class="ot">=</span><span class="fu">matrix</span>(<span class="at">data=</span><span class="cn">NA</span>, <span class="at">ncol=</span><span class="fu">length</span>(first_data),<span class="at">nrow =</span> <span class="dv">0</span>)</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(data_global_watering)<span class="ot">=</span><span class="fu">colnames</span>(first_data)</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(file <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(files_name)){</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>  first_data<span class="ot">=</span><span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="fu">paste0</span>(<span class="st">"data/water/watering/"</span>),files_name[file]), <span class="at">sep=</span><span class="st">";"</span>)</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(first_data)<span class="ot">=</span><span class="fu">colnames</span>(first_data[<span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(first_data)])</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>  first_data<span class="ot">=</span>first_data[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(first_data)<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>  data_global_watering<span class="ot">=</span><span class="fu">rbind</span>(data_global_watering,first_data)</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">class</span>(data_global_weighing<span class="sc">$</span>resultdate)</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>data_global_watering<span class="sc">$</span>type<span class="ot">=</span><span class="st">"watering"</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>data_global_weighing<span class="sc">$</span>type<span class="ot">=</span><span class="st">"weighing"</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>data_global_weighing<span class="sc">$</span>taskid<span class="ot">=</span><span class="fu">as.character</span>(data_global_weighing<span class="sc">$</span>taskid)</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>data_global_watering<span class="sc">$</span>taskid<span class="ot">=</span><span class="fu">as.character</span>(data_global_watering<span class="sc">$</span>taskid)</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>data_global_watering<span class="sc">$</span>valid<span class="ot">=</span><span class="fu">as.logical</span>(data_global_watering<span class="sc">$</span>valid)</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>data_global_watering<span class="sc">$</span>weightbefore<span class="ot">=</span><span class="fu">as.integer</span>(data_global_watering<span class="sc">$</span>weightbefore)</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>data_global_watering<span class="sc">$</span>weightafter<span class="ot">=</span><span class="fu">as.integer</span>(data_global_watering<span class="sc">$</span>weightafter)</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>global_weight<span class="ot">=</span><span class="fu">bind_rows</span>(data_global_weighing,data_global_watering)</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a><span class="co">#add weights after watering if deliveredquantity = 0</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>weighing_after<span class="ot">=</span>global_weight<span class="sc">%&gt;%</span><span class="fu">filter</span>(type<span class="sc">==</span><span class="st">"watering"</span>)<span class="sc">%&gt;%</span><span class="fu">filter</span>(deliveredquantity<span class="sc">==</span><span class="dv">0</span>)</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>weighing_after<span class="sc">$</span>type<span class="ot">=</span><span class="st">"watering2"</span></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>weighing_after<span class="sc">$</span>weightbefore<span class="ot">=</span>weighing_after<span class="sc">$</span>weightafter</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>weighing_after<span class="sc">$</span>taskid<span class="ot">=</span><span class="fu">paste0</span>(weighing_after<span class="sc">$</span>taskid,<span class="st">"bis"</span>)</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>global_weight<span class="sc">$</span>taskid<span class="ot">=</span><span class="fu">as.character</span>(global_weight<span class="sc">$</span>taskid)</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>global_weight<span class="ot">=</span><span class="fu">bind_rows</span>(global_weight,weighing_after)</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a><span class="co">#date and date_time format</span></span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>global_weight<span class="sc">$</span>resultdate_time<span class="ot">=</span><span class="fu">as.POSIXct</span>(global_weight<span class="sc">$</span>resultdate, <span class="at">format=</span><span class="st">"%d/%m/%Y %H:%M:%S"</span>)</span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>global_weight<span class="sc">$</span>resultdate<span class="ot">=</span><span class="fu">as.Date</span>(global_weight<span class="sc">$</span>resultdate, <span class="at">format=</span><span class="st">"%d/%m/%Y %H:%M:%S"</span>)</span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(global_weight,here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/water/weighing_watering_output/all_weighing_watering.csv"</span>))</span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>global_weight<span class="ot">=</span><span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/water/weighing_watering_output/all_weighing_watering.csv"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">plant_id=</span>plantid) <span class="sc">%&gt;%</span> </span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">merge</span>(.,<span class="fu">read_excel</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/water/diff_substrat_add_water.xlsx"</span>), <span class="at">sheet=</span> <span class="st">"news"</span>,<span class="at">skip =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(plant_id) <span class="sc">%&gt;%</span> </span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(plant_id,weightbefore_P0,dry_soil) <span class="sc">%&gt;%</span> </span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>                        dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">P0=</span>weightbefore_P0),</span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>                    <span class="at">by=</span><span class="st">"plant_id"</span>,<span class="at">all.y =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">miniserre=</span><span class="cn">NA</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tuteur=</span><span class="cn">NA</span>)</span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>data_tools<span class="ot">=</span><span class="fu">read_excel</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/water/tools_on_RT.xlsx"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">resultdate_with_miniserre_begin=</span><span class="fu">as.POSIXct</span>(<span class="fu">as.character</span>(resultdate_with_miniserre_begin),<span class="at">tz=</span><span class="st">"Europe/Paris"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">resultdate_with_miniserre_end=</span><span class="fu">as.POSIXct</span>(<span class="fu">as.character</span>(resultdate_with_miniserre_end),<span class="at">tz=</span><span class="st">"Europe/Paris"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tuteur=</span><span class="fu">as.POSIXct</span>(<span class="fu">as.character</span>(tuteur),<span class="at">tz=</span><span class="st">"Europe/Paris"</span>))</span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(data_tools<span class="sc">$</span>plant_id)){</span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(global_weight<span class="sc">$</span>studyname)){</span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(data_tools<span class="sc">$</span>plant_id[i]<span class="sc">==</span>global_weight<span class="sc">$</span>plant_id[j]){</span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(global_weight<span class="sc">$</span>resultdate_time[j]<span class="sc">&gt;=</span>data_tools<span class="sc">$</span>resultdate_with_miniserre_begin[i]){</span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(global_weight<span class="sc">$</span>resultdate_time[j]<span class="sc">&lt;</span>data_tools<span class="sc">$</span>resultdate_with_miniserre_end[i]){</span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a>          global_weight<span class="sc">$</span>miniserre[j]<span class="ot">=</span>data_tools<span class="sc">$</span>poids_miniserre[i]  </span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a>          global_weight<span class="sc">$</span>tuteur[j]<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a>        }<span class="cf">else</span> <span class="cf">if</span> (global_weight<span class="sc">$</span>resultdate_time[j]<span class="sc">&gt;</span>data_tools<span class="sc">$</span>tuteur[i]){</span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a>          global_weight<span class="sc">$</span>tuteur[j]<span class="ot">=</span>data_tools<span class="sc">$</span>tuteur_weight[i]  </span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a>          global_weight<span class="sc">$</span>miniserre[j]<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a>        }<span class="cf">else</span>{</span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a>          global_weight<span class="sc">$</span>miniserre[j]<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a>          global_weight<span class="sc">$</span>tuteur[j]<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb3-89"><a href="#cb3-89" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-90"><a href="#cb3-90" aria-hidden="true" tabindex="-1"></a>      }<span class="cf">else</span>{</span>
<span id="cb3-91"><a href="#cb3-91" aria-hidden="true" tabindex="-1"></a>        global_weight<span class="sc">$</span>miniserre[j]<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb3-92"><a href="#cb3-92" aria-hidden="true" tabindex="-1"></a>        global_weight<span class="sc">$</span>tuteur[j]<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb3-93"><a href="#cb3-93" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb3-94"><a href="#cb3-94" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-95"><a href="#cb3-95" aria-hidden="true" tabindex="-1"></a>    }      </span>
<span id="cb3-96"><a href="#cb3-96" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-97"><a href="#cb3-97" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-98"><a href="#cb3-98" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-99"><a href="#cb3-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-100"><a href="#cb3-100" aria-hidden="true" tabindex="-1"></a>global_weight<span class="ot">=</span>global_weight <span class="sc">%&gt;%</span></span>
<span id="cb3-101"><a href="#cb3-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fresh_soil=</span>weightbefore<span class="sc">-</span>P0<span class="sc">-</span>miniserre<span class="sc">-</span>tuteur) <span class="sc">%&gt;%</span> </span>
<span id="cb3-102"><a href="#cb3-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">water_in_rt=</span>fresh_soil<span class="sc">-</span>dry_soil) <span class="sc">%&gt;%</span> </span>
<span id="cb3-103"><a href="#cb3-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">humidity=</span>(fresh_soil<span class="sc">-</span>dry_soil)<span class="sc">/</span>dry_soil) <span class="co"># Calcul humidity loose</span></span>
<span id="cb3-104"><a href="#cb3-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-105"><a href="#cb3-105" aria-hidden="true" tabindex="-1"></a>global_weight_select<span class="ot">=</span>global_weight<span class="sc">%&gt;%</span></span>
<span id="cb3-106"><a href="#cb3-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(fresh_soil<span class="sc">&gt;</span><span class="dv">4000</span>)<span class="sc">%&gt;%</span></span>
<span id="cb3-107"><a href="#cb3-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(fresh_soil<span class="sc">&lt;</span><span class="dv">7500</span>) <span class="sc">%&gt;%</span> <span class="co">#for dont have outlier</span></span>
<span id="cb3-108"><a href="#cb3-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(humidity<span class="sc">&gt;</span><span class="fl">0.04</span>) <span class="sc">%&gt;%</span>  <span class="co">#for donc take begin value</span></span>
<span id="cb3-109"><a href="#cb3-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">merge</span>(.,plant_info_impaire,</span>
<span id="cb3-110"><a href="#cb3-110" aria-hidden="true" tabindex="-1"></a>    <span class="at">by=</span><span class="st">"plant_id"</span>,</span>
<span id="cb3-111"><a href="#cb3-111" aria-hidden="true" tabindex="-1"></a>    <span class="at">all.y =</span> <span class="cn">TRUE</span>) </span>
<span id="cb3-112"><a href="#cb3-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-113"><a href="#cb3-113" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(global_weight_select,here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/water/weighing_watering_output/weighing_watering.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li>Calculate the water loss</li>
</ul>
<p>Selection of rhizotubes that have two plants. Because if a plant does not germinate or has an abnormal phenotype it could induce errors for the evapotranspiration calculations</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>global_weight_select2<span class="ot">=</span>global_weight_select <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>plant_id <span class="sc">%in%</span> <span class="fu">as.vector</span>(plant_info_impaire <span class="sc">%&gt;%</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">filter</span>(induct_error_evapotranspi<span class="sc">==</span><span class="st">"x"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>                                    dplyr<span class="sc">::</span><span class="fu">pull</span>(<span class="st">"plant_id"</span>))</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>         )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Note, that this must be based on fresh soil and dry soil.</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>global_weight_select2 <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time=</span><span class="fu">format</span>(<span class="fu">as.POSIXct</span>(global_weight_select2<span class="sc">$</span>resultdate_time), <span class="at">format =</span> <span class="st">"%H:%M:%S"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="fu">as.POSIXct</span>(time, <span class="at">format=</span><span class="st">"%H:%M:%S"</span>), <span class="at">fill=</span>resultdate)) <span class="sc">+</span> </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="co">#also play with adjust such as adjust = 0.5</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_datetime</span>(<span class="at">breaks =</span> <span class="fu">date_breaks</span>(<span class="st">"2 hours"</span>), <span class="at">labels=</span><span class="fu">date_format</span>(<span class="st">"%H:%M"</span>)) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Houre in the day"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="water-in-the-rhizotube" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="water-in-the-rhizotube"><span class="header-section-number">3.2</span> Water in the rhizotube</h2>
<ul>
<li>Take the desired time interval and the least defective watering stations</li>
</ul>
<div class="cell" width="19">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>global_weight_select3<span class="ot">&lt;-</span>global_weight_select2<span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">as.Date</span>(resultdate)<span class="sc">&gt;</span><span class="fu">as.Date</span>(<span class="st">"2021-09-22"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(weightafter<span class="sc">&gt;</span><span class="dv">15000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(usedstationid <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"26"</span>,<span class="st">"36"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"weighing"</span>, <span class="st">"watering"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">day=</span><span class="fu">as.POSIXct</span>(resultdate_time)<span class="sc">-</span><span class="fu">as.POSIXct</span>(<span class="st">"2021-09-23 00:00:00"</span>))</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(global_weight_select3, <span class="st">"data/water/weighing_watering_output/global_weight_select3.csv"</span>)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">&lt;-</span><span class="fu">ggplot</span>(global_weight_select3, <span class="fu">aes</span>(<span class="at">x=</span>day, <span class="at">y=</span>water_in_rt, <span class="at">colour=</span><span class="fu">paste0</span>(condition,<span class="st">"_"</span>,usedstationid), <span class="at">group=</span><span class="fu">c</span>(<span class="fu">paste0</span>(condition,<span class="st">"_"</span>,usedstationid)))) <span class="sc">+</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="fl">0.7</span>,<span class="at">alpha=</span>.<span class="dv">4</span>)<span class="sc">+</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()<span class="sc">+</span><span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Date of watering or weighing"</span>,<span class="at">y=</span><span class="st">"Water in Rhizotube (ml)"</span>,<span class="at">color=</span><span class="st">"condition </span><span class="sc">\n</span><span class="st">+usedstationid"</span>)<span class="sc">+</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">byrow =</span> T))<span class="sc">+</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">round</span>(<span class="fu">seq</span>(<span class="fu">min</span>(<span class="fu">as.integer</span>(global_weight_select3<span class="sc">$</span>day)), <span class="fu">as.integer</span>(<span class="fu">max</span>(global_weight_select3<span class="sc">$</span>day)), <span class="at">by =</span> <span class="dv">2</span>),<span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"bottom"</span>)</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>error_balance_begin_XP<span class="ot">=</span> <span class="fl">0.01</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>p_soil_water_content<span class="ot">&lt;-</span><span class="fu">ggplot</span>(</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>  global_weight_select3 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(recolte<span class="sc">==</span><span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(day<span class="sc">&gt;</span><span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">climat_condition=</span><span class="fu">paste0</span>(water_condition,<span class="st">"_"</span>,heat_condition)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">humidity=</span><span class="fu">ifelse</span>(climat_condition<span class="sc">==</span><span class="st">"WS_HS"</span>,humidity<span class="sc">+</span>error_balance_begin_XP,humidity)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">condition=</span><span class="fu">factor</span>(condition,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">"Sto_WW_OT"</span>,<span class="st">"Sto_WW_HS"</span>,<span class="st">"Sto_WS_OT"</span>,<span class="st">"Sto_WS_HS"</span>,<span class="st">"Wen_WW_OT"</span>,<span class="st">"Wen_WW_HS"</span>,<span class="st">"Wen_WS_OT"</span>,<span class="st">"Wen_WS_HS"</span>)))  <span class="sc">%&gt;%</span> </span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">climat_condition=</span><span class="fu">factor</span>(climat_condition,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">"WW_OT"</span>,<span class="st">"WS_OT"</span>,<span class="st">"WW_HS"</span>,<span class="st">"WS_HS"</span>)))</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>  , <span class="fu">aes</span>(<span class="at">x=</span>day<span class="dv">-1</span>, <span class="at">y=</span>humidity, <span class="at">col=</span>climat_condition,<span class="at">fill=</span>climat_condition,<span class="at">linetype=</span>genotype)) <span class="sc">+</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_rect</span>(<span class="at">xmin =</span> <span class="dv">5</span>, <span class="at">xmax =</span> <span class="dv">20</span>, <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">ymax =</span> <span class="fl">0.11</span>, <span class="at">fill =</span> <span class="st">"#c9d5ea"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>,<span class="at">col=</span><span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_rect</span>(<span class="at">xmin =</span> <span class="dv">5</span>, <span class="at">xmax =</span> <span class="dv">10</span>, <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">ymax =</span> <span class="cn">Inf</span>, <span class="at">fill =</span> <span class="st">"lightgray"</span>, <span class="at">alpha =</span> <span class="fl">0.02</span>,<span class="at">col=</span><span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_rect</span>(<span class="at">xmin =</span> <span class="dv">15</span>, <span class="at">xmax =</span> <span class="dv">20</span>, <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">ymax =</span> <span class="cn">Inf</span>, <span class="at">fill =</span> <span class="st">"lightgray"</span>, <span class="at">alpha =</span> <span class="fl">0.02</span>,<span class="at">col=</span><span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="fl">0.7</span>,<span class="at">alpha=</span>.<span class="dv">4</span>)<span class="sc">+</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()<span class="sc">+</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Number of days after transplantation"</span>,<span class="at">y=</span><span class="st">"Soil water content (%)"</span>,<span class="at">color=</span><span class="st">"Treatment"</span>,<span class="at">fill=</span><span class="st">"Treatment"</span>,<span class="at">linetype=</span><span class="st">"Genotype"</span>)<span class="sc">+</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">byrow =</span> T))<span class="sc">+</span></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_x_continuous(breaks = round(seq(min(as.integer(global_weight_select3$day)), as.integer(max(global_weight_select3$day)), by = 5),1))+</span></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_x_datetime(date_breaks= "2 days", date_minor_breaks = "12 hour")+</span></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>    <span class="co">#scale_y_continuous(breaks=1)</span></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span>climate_pallet)<span class="sc">+</span></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>climate_pallet)<span class="sc">+</span></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"right"</span>)<span class="sc">+</span></span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>   my_theme</span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave(here::here("report/water/plot/Water_in_RT.svg"), </span></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a><span class="co">#        p1, width = 20,height = 16, units = "cm")</span></span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"report/water/plot/Water_in_RT.png"</span>), </span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>       p1, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">16</span>, <span class="at">units =</span> <span class="st">"cm"</span>, <span class="at">dpi =</span> <span class="dv">600</span>)</span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave(here::here("report/water/plot/soil_water_content.svg"), </span></span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a><span class="co">#        p_soil_water_content, width = 20,height = 16, units = "cm")</span></span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"report/water/plot/soil_water_content.png"</span>), </span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>       p_soil_water_content, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">16</span>, <span class="at">units =</span> <span class="st">"cm"</span>, <span class="at">dpi =</span> <span class="dv">600</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><a href="plot/Water_in_RT.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="plot/Water_in_RT.png" class="img-fluid"></a></p>
<div id="fig-water_content" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-water_content-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="plot/soil_water_content.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;3.1: "><img src="plot/soil_water_content.png" id="fig-water_content" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-water_content-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.1
</figcaption>
</figure>
</div>
<ul>
<li>Find the date of the next measurement for the same rizotube. Attention the last measurement is deleted.</li>
</ul>
</section>
<section id="evapotranspiration" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="evapotranspiration"><span class="header-section-number">3.3</span> Evapotranspiration</h2>
<section id="kinetics" class="level3" data-number="3.3.1">
<h3 data-number="3.3.1" class="anchored" data-anchor-id="kinetics"><span class="header-section-number">3.3.1</span> Kinetics</h3>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Caution
</div>
</div>
<div class="callout-body-container callout-body">
<p><em>Be careful, this step takes a lot of time This step also adds a night day column and a night morning and afternoon column. This part also measures the time between two weighings</em></p>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># /!\ take time 5 min at least</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat_col</span>(<span class="st">"Caution: you have to wait a long time here"</span>, <span class="st">"red"</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>global_weight_select3<span class="ot">=</span><span class="fu">read.csv</span>(<span class="st">"data/water/weighing_watering_output/global_weight_select3.csv"</span>)[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>global_weight_select3<span class="sc">$</span>next_weight<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>levels_factor_plant_id<span class="ot">=</span><span class="fu">levels</span>(<span class="fu">as.factor</span>(global_weight_select3<span class="sc">$</span>plant_id))</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>pb <span class="ot">=</span> <span class="fu">txtProgressBar</span>(<span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="fu">length</span>(levels_factor_plant_id), <span class="at">initial =</span> <span class="dv">0</span>,<span class="at">style=</span><span class="dv">3</span>)<span class="co">#progresse bar </span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> levels_factor_plant_id){</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">setTxtProgressBar</span>(pb,<span class="fu">match</span>(i,levels_factor_plant_id)) <span class="co">#progresse bar</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    data_watering_select_x<span class="ot">=</span>global_weight_select3 <span class="sc">%&gt;%</span> </span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(plant_id<span class="sc">==</span>i) <span class="sc">%&gt;%</span> </span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">arrange</span>(resultdate_time)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    levels_factor_resultdate_time<span class="ot">=</span>data_watering_select_x<span class="sc">$</span>resultdate_time</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(levels_factor_resultdate_time)){</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(global_weight_select3<span class="sc">$</span>studyname)){</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="fu">as.character</span>(global_weight_select3<span class="sc">$</span>plant_id[k])<span class="sc">==</span>i){</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>         <span class="co"># print(data_watering_select$plantid[k])  </span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span>(global_weight_select3<span class="sc">$</span>resultdate_time[k]<span class="sc">==</span>levels_factor_resultdate_time[j]){</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>            global_weight_select3<span class="sc">$</span>next_weight[k]<span class="ot">=</span><span class="fu">as.character</span>(levels_factor_resultdate_time[j<span class="sc">+</span><span class="dv">1</span>])</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>            <span class="co">#print(paste(i,levels_factor_resultdate_time[j],levels_factor_resultdate_time[j+1], sep="_"))</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>df_evapotranspi<span class="ot">=</span>global_weight_select3 <span class="sc">%&gt;%</span> </span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(next_weight)</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>df_evapotranspi<span class="sc">$</span>water_after<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>pb <span class="ot">=</span> <span class="fu">txtProgressBar</span>(<span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="fu">length</span>(df_evapotranspi<span class="sc">$</span>studyname), <span class="at">initial =</span> <span class="dv">0</span>,<span class="at">style=</span><span class="dv">3</span>)<span class="co">#progresse bar </span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(df_evapotranspi<span class="sc">$</span>studyname)){</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(global_weight_select3<span class="sc">$</span>studyname)){</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(df_evapotranspi<span class="sc">$</span>plant_id[i]<span class="sc">==</span>global_weight_select3<span class="sc">$</span>plant_id[j]){</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (df_evapotranspi<span class="sc">$</span>next_weight[i]<span class="sc">==</span>global_weight_select3<span class="sc">$</span>resultdate_time[j]){</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>      df_evapotranspi<span class="sc">$</span>water_after[i]<span class="ot">=</span>global_weight_select3<span class="sc">$</span>water_in_rt[j]</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>      <span class="fu">setTxtProgressBar</span>(pb,i) <span class="co">#progresse bar</span></span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>df_evapotranspi<span class="sc">$</span>evapotranspiration<span class="ot">=</span>df_evapotranspi<span class="sc">$</span>water_in_rt<span class="sc">-</span>df_evapotranspi<span class="sc">$</span>water_after<span class="sc">+</span>df_evapotranspi<span class="sc">$</span>deliveredquantity</span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a><span class="co">#diff time enter the two weight</span></span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>df_evapotranspi<span class="sc">$</span>diff_resultdate_time<span class="ot">=</span><span class="fu">as.POSIXct</span>(df_evapotranspi<span class="sc">$</span>next_weight)<span class="sc">-</span><span class="fu">as.POSIXct</span>(df_evapotranspi<span class="sc">$</span>resultdate_time)</span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a><span class="co">#transforme date time of next_weight in juste time for separate by morning afternoone night</span></span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>df_evapotranspi<span class="sc">$</span>next_weight_time<span class="ot">=</span><span class="fu">format</span>(<span class="fu">strftime</span>(df_evapotranspi<span class="sc">$</span>next_weight, <span class="at">format =</span> <span class="st">"%H:%M:%S"</span>))</span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>df_evapotranspi<span class="sc">$</span>night_day<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a>pb <span class="ot">=</span> <span class="fu">txtProgressBar</span>(<span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="fu">length</span>(df_evapotranspi<span class="sc">$</span>studyname), <span class="at">initial =</span> <span class="dv">0</span>,<span class="at">style=</span><span class="dv">3</span>)<span class="co">#progresse bar </span></span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(df_evapotranspi<span class="sc">$</span>studyname)){</span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">format</span>(<span class="fu">strftime</span>(df_evapotranspi<span class="sc">$</span>next_weight[i], <span class="at">format =</span> <span class="st">"%H:%M:%S"</span>))<span class="sc">&lt;</span><span class="fu">format</span>(<span class="fu">strftime</span>(<span class="st">"2021-10-01 09:18:00"</span>, <span class="at">format =</span> <span class="st">"%H:%M:%S"</span>))){</span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">format</span>(<span class="fu">strftime</span>(df_evapotranspi<span class="sc">$</span>resultdate_time[i], <span class="at">format =</span> <span class="st">"%H:%M:%S"</span>))<span class="sc">&gt;</span><span class="fu">format</span>(<span class="fu">strftime</span>(<span class="st">"2021-10-01 17:00:00"</span>, <span class="at">format =</span> <span class="st">"%H:%M:%S"</span>))){</span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print(paste(data_watering_select_transpiration_select$time[i],data_watering_select_transpiration_select$next_weight_time[i],sep="_"))</span></span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a>      df_evapotranspi<span class="sc">$</span>night_day[i]<span class="ot">=</span><span class="st">"night"</span></span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a>    }<span class="cf">else</span>{</span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a>      df_evapotranspi<span class="sc">$</span>night_day[i]<span class="ot">=</span><span class="st">"day"</span></span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb7-66"><a href="#cb7-66" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb7-67"><a href="#cb7-67" aria-hidden="true" tabindex="-1"></a>    df_evapotranspi<span class="sc">$</span>night_day[i]<span class="ot">=</span><span class="st">"day"</span></span>
<span id="cb7-68"><a href="#cb7-68" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-69"><a href="#cb7-69" aria-hidden="true" tabindex="-1"></a> <span class="fu">setTxtProgressBar</span>(pb,i) <span class="co">#progresse bar </span></span>
<span id="cb7-70"><a href="#cb7-70" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-71"><a href="#cb7-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-72"><a href="#cb7-72" aria-hidden="true" tabindex="-1"></a>df_evapotranspi<span class="sc">$</span>morning_afternoon<span class="ot">=</span><span class="st">"night"</span></span>
<span id="cb7-73"><a href="#cb7-73" aria-hidden="true" tabindex="-1"></a>pb <span class="ot">=</span> <span class="fu">txtProgressBar</span>(<span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="fu">length</span>(df_evapotranspi<span class="sc">$</span>studyname), <span class="at">initial =</span> <span class="dv">0</span>,<span class="at">style=</span><span class="dv">3</span>) <span class="co">#progresse bar </span></span>
<span id="cb7-74"><a href="#cb7-74" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(df_evapotranspi<span class="sc">$</span>studyname)){</span>
<span id="cb7-75"><a href="#cb7-75" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(df_evapotranspi<span class="sc">$</span>night_day[i]<span class="sc">==</span><span class="st">"day"</span>){</span>
<span id="cb7-76"><a href="#cb7-76" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">format</span>(<span class="fu">strftime</span>(df_evapotranspi<span class="sc">$</span>resultdate_time[i], <span class="at">format =</span> <span class="st">"%H:%M:%S"</span>))<span class="sc">&lt;</span><span class="fu">format</span>(<span class="fu">strftime</span>(<span class="st">"2021-10-01 11:00:00"</span>, <span class="at">format =</span> <span class="st">"%H:%M:%S"</span>))){</span>
<span id="cb7-77"><a href="#cb7-77" aria-hidden="true" tabindex="-1"></a>      df_evapotranspi<span class="sc">$</span>morning_afternoon[i]<span class="ot">=</span><span class="st">"morning"</span></span>
<span id="cb7-78"><a href="#cb7-78" aria-hidden="true" tabindex="-1"></a>    }<span class="cf">else</span>(df_evapotranspi<span class="sc">$</span>morning_afternoon[i]<span class="ot">=</span><span class="st">"afternoon"</span>)</span>
<span id="cb7-79"><a href="#cb7-79" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-80"><a href="#cb7-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setTxtProgressBar</span>(pb,i) <span class="co">#progresse bar </span></span>
<span id="cb7-81"><a href="#cb7-81" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-82"><a href="#cb7-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-83"><a href="#cb7-83" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(df_evapotranspi,here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/water/weighing_watering_output/df_evapotranspi.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li>Plot exemple for <em>RT1067</em></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>df_evapotranspi<span class="ot">=</span><span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/water/weighing_watering_output/df_evapotranspi.csv"</span>))[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>df_evapotranspi<span class="sc">$</span>resultdate_time<span class="ot">=</span><span class="fu">as.POSIXct</span>(df_evapotranspi<span class="sc">$</span>resultdate_time)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>plot_x<span class="ot">=</span>df_evapotranspi <span class="sc">%&gt;%</span> </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(plant_id<span class="sc">==</span><span class="st">"1069"</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>resultdate_time, <span class="at">y=</span>evapotranspiration<span class="sc">/</span><span class="dv">2</span>, <span class="at">colour=</span><span class="fu">paste0</span>(condition,<span class="st">"_"</span>,usedstationid), <span class="at">group=</span><span class="fu">c</span>(<span class="fu">paste0</span>(condition,<span class="st">"_"</span>,usedstationid)))) <span class="sc">+</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se=</span>F)<span class="sc">+</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>       <span class="fu">scale_x_datetime</span>(<span class="at">breaks=</span>(<span class="st">"1 day"</span>), <span class="at">minor_breaks=</span>(<span class="st">"1 hour"</span>),<span class="at">labels =</span> <span class="fu">date_format</span>(<span class="st">"%b-%d %H:%M:%S"</span>))<span class="sc">+</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Date and time"</span>, <span class="at">y=</span><span class="st">"Evapotranspiration for one plante of one </span><span class="sc">\n</span><span class="st"> rhizotube (ml) between two watering or weighing"</span>,<span class="at">color=</span><span class="st">"condition </span><span class="sc">\n</span><span class="st">+usedstationid"</span>)<span class="sc">+</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"bottom"</span>)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"report/water/plot/evapotranspiration_1069.svg"</span>), </span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>       plot_x, <span class="at">width =</span> <span class="dv">20</span>,<span class="at">height =</span> <span class="dv">16</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><a href="plot/evapotranspiration_1069.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="plot/evapotranspiration_1069.svg" class="img-fluid"></a></p>
<p>(plot/water/evapotranspiration_1069.svg)</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>sum_by_date<span class="ot">=</span><span class="fu">aggregate</span>(df_evapotranspi<span class="sc">$</span>evapotranspiration, <span class="at">by=</span><span class="fu">list</span>(df_evapotranspi<span class="sc">$</span>plant_id, df_evapotranspi<span class="sc">$</span>condition,df_evapotranspi<span class="sc">$</span>resultdate,df_evapotranspi<span class="sc">$</span>genotype,df_evapotranspi<span class="sc">$</span>heat_condition), <span class="at">FUN=</span>sum)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>plot_x<span class="ot">=</span>sum_by_date <span class="sc">%&gt;%</span>   <span class="fu">mutate</span>(<span class="at">Group.1=</span><span class="fu">factor</span>(Group<span class="fl">.1</span>,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">"Sto_WW_OT"</span>,<span class="st">"Sto_WW_HS"</span>,<span class="st">"Sto_WS_OT"</span>,<span class="st">"Sto_WS_HS"</span>,<span class="st">"Wen_WW_OT"</span>,<span class="st">"Wen_WW_HS"</span>,<span class="st">"Wen_WS_OT"</span>,<span class="st">"Wen_WS_HS"</span>)))  <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">as.factor</span>(Group<span class="fl">.3</span>),<span class="at">y=</span>x<span class="sc">/</span><span class="dv">2</span>,<span class="at">fill=</span>Group<span class="fl">.2</span>))<span class="sc">+</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.alpha =</span> <span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#facet_grid(Group.5~.)+</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_point(position=position_jitterdodge(),alpha=0.3)+</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>manu_palett)<span class="sc">+</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Date"</span>, <span class="at">y=</span><span class="st">"Evapotranspiration for one plante of one rhizotube (ml) during on day"</span>)<span class="sc">+</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"bottom"</span>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"report/water/plot/evapotranspiration_each_plant.svg"</span>), </span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>       plot_x, <span class="at">width =</span> <span class="dv">20</span>,<span class="at">height =</span> <span class="dv">16</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><a href="plot/evapotranspiration_each_plant.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="plot/evapotranspiration_each_plant.svg" class="img-fluid"></a></p>
<ul>
<li>Error detection</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>plot_x<span class="ot">&lt;-</span> df_evapotranspi <span class="sc">%&gt;%</span>   <span class="fu">mutate</span>(<span class="at">condition=</span><span class="fu">factor</span>(condition,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">"Sto_WW_OT"</span>,<span class="st">"Sto_WW_HS"</span>,<span class="st">"Sto_WS_OT"</span>,<span class="st">"Sto_WS_HS"</span>,<span class="st">"Wen_WW_OT"</span>,<span class="st">"Wen_WW_HS"</span>,<span class="st">"Wen_WS_OT"</span>,<span class="st">"Wen_WS_HS"</span>)))  <span class="sc">%&gt;%</span>  </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">as.POSIXct</span>(<span class="fu">format</span>(<span class="fu">as.POSIXct</span>(resultdate_time),<span class="at">format =</span> <span class="st">"%H:%M:%S"</span>),<span class="at">format =</span> <span class="st">"%H:%M:%S"</span>),<span class="at">y=</span>evapotranspiration<span class="sc">/</span><span class="dv">2</span>,<span class="at">col=</span>condition))<span class="sc">+</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>resultdate)<span class="sc">+</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values=</span>manu_palett)<span class="sc">+</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Evapotranspiration between two weighings (ml) for one plant"</span>, <span class="at">x=</span><span class="st">"Date time"</span>)<span class="sc">+</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"bottom"</span>)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"report/water/plot/find_error_evapo.svg"</span>), </span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>       plot_x, <span class="at">width =</span> <span class="dv">20</span>,<span class="at">height =</span> <span class="dv">18</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><a href="plot/find_error_evapo.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="plot/find_error_evapo.svg" class="img-fluid"></a></p>
<p>Sometimes have less than three waterings per day and at different times or more than 3. This can lead to calculation errors later on the script.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>plot_x<span class="ot">&lt;-</span> df_evapotranspi <span class="sc">%&gt;%</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">condition=</span><span class="fu">factor</span>(condition,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">"Sto_WW_OT"</span>,<span class="st">"Sto_WW_HS"</span>,<span class="st">"Sto_WS_OT"</span>,<span class="st">"Sto_WS_HS"</span>,<span class="st">"Wen_WW_OT"</span>,<span class="st">"Wen_WW_HS"</span>,<span class="st">"Wen_WS_OT"</span>,<span class="st">"Wen_WS_HS"</span>)))  <span class="sc">%&gt;%</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">as.POSIXct</span>(<span class="fu">format</span>(<span class="fu">as.POSIXct</span>(resultdate_time),<span class="at">format =</span> <span class="st">"%H:%M:%S"</span>),<span class="at">format =</span> <span class="st">"%H:%M:%S"</span>),<span class="at">y=</span>diff_resultdate_time<span class="sc">/</span><span class="dv">60</span>,<span class="at">col=</span>condition))<span class="sc">+</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Time (hours) between two weighing measurements for each rhizotube"</span>, <span class="at">x=</span><span class="st">"Date and time"</span>)<span class="sc">+</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>resultdate)<span class="sc">+</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span>manu_palett)<span class="sc">+</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"bottom"</span>)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"report/water/plot/find_error_evapo_time_between.svg"</span>), </span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>       plot_x, <span class="at">width =</span> <span class="dv">20</span>,<span class="at">height =</span> <span class="dv">18</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><a href="plot/find_error_evapo_time_between.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="plot/find_error_evapo_time_between.svg" class="img-fluid"></a></p>
<p><strong>Why do I have the RT 1035 which has such a huge value between two waterings?</strong> Because there are missing values for the 1035 between the 27th at 7:45 and the 29th at 12:06. On the 27th the measurements of 14:27, 18:05 and 20:30 are missing. On the 28th the data of 6:06, 12:05 and 18:05 and on the 29th the data of 6:06.</p>
<p>Division of the evapotranspiration by the time between two weighing measurements. That is, divide by the weight after watering minus the weight before watering.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#if i divide one by one</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>df_evapotranspi<span class="sc">$</span>div<span class="ot">=</span>df_evapotranspi<span class="sc">$</span>evapotranspiration<span class="sc">/</span>(<span class="fu">as.numeric</span>(df_evapotranspi<span class="sc">$</span>diff_resultdate_time)<span class="sc">/</span><span class="dv">60</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>plot_x<span class="ot">&lt;-</span> df_evapotranspi <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">condition=</span><span class="fu">factor</span>(condition,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">"Sto_WW_OT"</span>,<span class="st">"Sto_WW_HS"</span>,<span class="st">"Sto_WS_OT"</span>,<span class="st">"Sto_WS_HS"</span>,<span class="st">"Wen_WW_OT"</span>,<span class="st">"Wen_WW_HS"</span>,<span class="st">"Wen_WS_OT"</span>,<span class="st">"Wen_WS_HS"</span>)))  <span class="sc">%&gt;%</span> </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(div<span class="sc">&gt;-</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">as.POSIXct</span>(<span class="fu">format</span>(<span class="fu">as.POSIXct</span>(resultdate_time),<span class="at">format =</span> <span class="st">"%H:%M:%S"</span>),<span class="at">format =</span> <span class="st">"%H:%M:%S"</span>),<span class="at">y=</span>div<span class="sc">/</span><span class="dv">2</span>,<span class="at">col=</span>condition))<span class="sc">+</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="fl">1.2</span>, <span class="at">alpha=</span>.<span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Evapotranspiration of a plant per rhizotube (ml."</span>,hour<span class="sc">^</span>{<span class="sc">-</span><span class="dv">1</span>},<span class="st">")"</span>)), <span class="at">x=</span><span class="st">"Date and time"</span>)<span class="sc">+</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>resultdate)<span class="sc">+</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span>manu_palett)<span class="sc">+</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"bottom"</span>)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"report/water/plot/evapo_by_plant_per_RT.svg"</span>), </span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>       plot_x, <span class="at">width =</span> <span class="dv">22</span>,<span class="at">height =</span> <span class="dv">18</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><a href="plot/evapo_by_plant_per_RT.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="plot/evapo_by_plant_per_RT.svg" class="img-fluid"></a></p>
<p>Then I remove some aberrant data or that could bother me for the calculations. I remove the values of 2021-09-24 because the last weighing was done at 15h. I also remove the time between two weighing more than 16h30 and finally I remove the results of rhizotube 3 (aberrant results).</p>
<p>If I separate the evaporation between day and night. If I separate the evapotranspiration between day and night. One can see logically that evapotranspiration is much lower at night than during the day. During the day and in the course of the experiment, there is an increasing increase in evapotranspiration for plants in well-watered conditions. During the day, and during the first heat wave (from day X to day X), evapotranspiration increases for both genotypes, and then returns to a state close to the one observed in plants in optimal temperature conditions. During the second heat wave (from day X to day X), during the day and in well-watered conditions, there could be have a difference between the two genotypes. Wendy could be have a higher evapotranspiration in this condition. Can this be explained by their different aerial and root architecture (for the same biomass)? Towards the end we can see the re-watering of the plants in stressed condition.</p>
<div id="fig-evapotranspiration" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-evapotranspiration-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="plot/evapotranspi_genotype_day_night.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8" title="Figure&nbsp;3.2: "><img src="plot/evapotranspi_genotype_day_night.png" id="fig-evapotranspiration" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-evapotranspiration-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.2
</figcaption>
</figure>
</div>
<p>If we look at the differences between conditions for each period of the day (morning, afternoon, evening) but not in ml.hours but in cumulative. There does not seem to be any major difference in evapotranspiration between these three periods.</p>
<p><a href="plot/evapotranspi_genotype_morning_afternoon_night.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img src="plot/evapotranspi_genotype_morning_afternoon_night.svg" class="img-fluid"></a></p>
</section>
<section id="total-evapotranspiration" class="level3" data-number="3.3.2">
<h3 data-number="3.3.2" class="anchored" data-anchor-id="total-evapotranspiration"><span class="header-section-number">3.3.2</span> Total evapotranspiration</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>df_evapotranspi3<span class="ot">=</span><span class="fu">merge</span>(</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  df_evapotranspi2,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read.csv2</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/physio/global_physio.csv"</span>)) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(plant_id,weight_root, leaf_area,sum_biomass),</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">by=</span><span class="st">"plant_id"</span>,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">all =</span> T)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(df_evapotranspi3, here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/water/weighing_watering_output/df_evapo3.csv"</span>))</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co">#mean of harvest 1</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co">#sum evapotransipration by plant_id</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>sum_evapo_end<span class="ot">=</span>df_evapotranspi3 <span class="sc">%&gt;%</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(plant_id, condition, recolte) <span class="sc">%&gt;%</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">.groups =</span> <span class="st">'drop'</span>,<span class="at">sum_total_evapotranspiration=</span><span class="fu">sum</span>(evapotranspiration)) <span class="sc">%&gt;%</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(sum_total_evapotranspiration)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="do">## write result evapotranspi3</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(sum_evapo_end,here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/water/weighing_watering_output/sum_evapotranspi.csv"</span>))</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>sum_evapo_end_1<span class="ot">=</span>sum_evapo_end <span class="sc">%&gt;%</span> <span class="fu">filter</span>(recolte<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>sum_evapo_end_2<span class="ot">=</span>sum_evapo_end <span class="sc">%&gt;%</span> <span class="fu">filter</span>(recolte<span class="sc">==</span><span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">condition=</span><span class="fu">factor</span>(condition,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">"Sto_WW_OT"</span>,<span class="st">"Sto_WS_OT"</span>,<span class="st">"Sto_WW_HS"</span>,<span class="st">"Sto_WS_HS"</span>,<span class="st">"Wen_WW_OT"</span>,<span class="st">"Wen_WS_OT"</span>,<span class="st">"Wen_WW_HS"</span>,<span class="st">"Wen_WS_HS"</span>)))</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_x=stat_analyse(</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a><span class="co">#     data=sum_evapo_end_1 %&gt;% </span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a><span class="co">#       data.frame() %&gt;%  </span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a><span class="co">#       mutate(condition=factor(condition,levels=c("Sto_WW_OT","Sto_WS_OT","Sto_WW_HS","Sto_WS_HS","Wen_WW_OT","Wen_WS_OT","Wen_WW_HS","Wen_WS_HS"))),</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a><span class="co">#     column_value = "sum_total_evapotranspiration",</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a><span class="co">#     category_variables = "condition",</span></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a><span class="co">#     grp_var = "",</span></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a><span class="co">#     show_plot = T,</span></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a><span class="co">#     outlier_show = F, </span></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a><span class="co">#     label_outlier = "plant_id",</span></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a><span class="co">#     biologist_stats = T,</span></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a><span class="co">#     Ylab_i = "Total evaporation of plants from harvest 1 before harvest (ml)"</span></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_x[["plot"]]+</span></span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(color=NULL,fill=NULL,subtitle = df_alpha_info$for_title[i])+</span></span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme (axis.ticks.x = element_blank(),# Masquer les ticks de l'axe x</span></span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a><span class="co">#          axis.text.x=element_blank (),</span></span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a><span class="co">#          axis.title.x = element_blank(),</span></span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a><span class="co">#          legend.position = "none",</span></span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a><span class="co">#          plot.subtitle = element_text(face = "bold"),</span></span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a><span class="co">#          plot.caption = element_blank()</span></span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a><span class="co">#          ) </span></span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">=</span><span class="fu">Plettre_modif</span>(</span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a>  <span class="at">Z=</span>sum_evapo_end_1,</span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a>  <span class="at">X=</span>sum_evapo_end_1<span class="sc">$</span>condition,</span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y=</span>sum_evapo_end_1<span class="sc">$</span>sum_total_evapotranspiration<span class="sc">/</span><span class="dv">2</span>,</span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a>  <span class="at">Xlab =</span> <span class="st">"Condition"</span>,</span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a>  <span class="at">Ylab =</span> <span class="st">"Total evaporation of plants from harvest 1 before harvest (ml)"</span>, </span>
<span id="cb14-53"><a href="#cb14-53" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y_bis =</span> <span class="st">"sum_total_evapotranspiration"</span>,</span>
<span id="cb14-54"><a href="#cb14-54" aria-hidden="true" tabindex="-1"></a>  <span class="at">Tukey=</span>T,</span>
<span id="cb14-55"><a href="#cb14-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">outlier_show =</span> F,</span>
<span id="cb14-56"><a href="#cb14-56" aria-hidden="true" tabindex="-1"></a>  <span class="at">label_outlier =</span> <span class="st">"plant_id"</span>)</span>
<span id="cb14-57"><a href="#cb14-57" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">=</span>p1[[<span class="dv">1</span>]]</span>
<span id="cb14-58"><a href="#cb14-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-59"><a href="#cb14-59" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">=</span><span class="fu">Plettre_modif</span>(</span>
<span id="cb14-60"><a href="#cb14-60" aria-hidden="true" tabindex="-1"></a>  <span class="at">Z=</span>sum_evapo_end_2,</span>
<span id="cb14-61"><a href="#cb14-61" aria-hidden="true" tabindex="-1"></a>  <span class="at">X=</span>sum_evapo_end_2<span class="sc">$</span>condition,</span>
<span id="cb14-62"><a href="#cb14-62" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y=</span>sum_evapo_end_2<span class="sc">$</span>sum_total_evapotranspiration<span class="sc">/</span><span class="dv">2</span>,</span>
<span id="cb14-63"><a href="#cb14-63" aria-hidden="true" tabindex="-1"></a>  <span class="at">Xlab =</span> <span class="st">"Condition"</span>,</span>
<span id="cb14-64"><a href="#cb14-64" aria-hidden="true" tabindex="-1"></a>  <span class="at">Ylab =</span> <span class="st">"Total evaporation of plants before harvest 2 (ml)"</span>,</span>
<span id="cb14-65"><a href="#cb14-65" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y_bis =</span> <span class="st">"sum_total_evapotranspiration"</span>,</span>
<span id="cb14-66"><a href="#cb14-66" aria-hidden="true" tabindex="-1"></a>  <span class="at">Tukey=</span>T,</span>
<span id="cb14-67"><a href="#cb14-67" aria-hidden="true" tabindex="-1"></a>  <span class="at">outlier_show =</span> F,</span>
<span id="cb14-68"><a href="#cb14-68" aria-hidden="true" tabindex="-1"></a>  <span class="at">label_outlier =</span> <span class="st">"plant_id"</span>)</span>
<span id="cb14-69"><a href="#cb14-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-70"><a href="#cb14-70" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">=</span>p2[[<span class="dv">1</span>]]</span>
<span id="cb14-71"><a href="#cb14-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-72"><a href="#cb14-72" aria-hidden="true" tabindex="-1"></a><span class="co">#plot_grid(p1, p2, ncol = 2, nrow = 1)</span></span>
<span id="cb14-73"><a href="#cb14-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-74"><a href="#cb14-74" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"report/water/plot/total_evapotranspi.svg"</span>), </span>
<span id="cb14-75"><a href="#cb14-75" aria-hidden="true" tabindex="-1"></a>       <span class="fu">plot_grid</span>(p1, p2, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">1</span>), <span class="at">width =</span> <span class="dv">22</span>,<span class="at">height =</span> <span class="dv">18</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><a href="plot/total_evapotranspi.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-10"><img src="plot/total_evapotranspi.svg" class="img-fluid"></a></p>
</section>
</section>
<section id="wue-and-srwu" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="wue-and-srwu"><span class="header-section-number">3.4</span> WUE and sRWU</h2>
<p>Since we have chosen to make correlations between variables measured by plant and the efficiencies of water, element, radiation ‚Ä¶ we have chosen to make averages on the first harvest and to make calculations with these averages (H1) vs harvest 2 (HS).</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>df_use_for_WUE<span class="ot">=</span><span class="fu">merge</span>(</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/water/weighing_watering_output/df_evapo3.csv"</span>)) <span class="sc">%&gt;%</span> <span class="fu">drop_na</span>(evapotranspiration)<span class="sc">%&gt;%</span> <span class="fu">drop_na</span>(sum_biomass),</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(<span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/water/weighing_watering_output/df_evapo3.csv"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(plant_id, condition, recolte) <span class="sc">%&gt;%</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">.groups =</span> <span class="st">'drop'</span>,<span class="at">sum_total_evapotranspiration=</span><span class="fu">sum</span>(evapotranspiration)) <span class="sc">%&gt;%</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(sum_total_evapotranspiration)) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(plant_id,sum_total_evapotranspiration ) <span class="sc">%&gt;%</span> <span class="fu">drop_na</span>(sum_total_evapotranspiration),</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">all=</span>T, <span class="at">by=</span><span class="st">"plant_id"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(recolte,condition)<span class="sc">%&gt;%</span> </span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">mean_sum_biomass =</span><span class="fu">mean</span>(sum_biomass),</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">mean_sum_total_evapotranspiration=</span><span class="fu">mean</span>(sum_total_evapotranspiration),<span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">%&gt;%</span> <span class="co">#.groups = 'drop' for delet warning message</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(mean_sum_biomass) <span class="sc">%&gt;%</span> </span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mean_sum_biomass=</span>mean_sum_biomass<span class="sc">*</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mean_sum_total_evapotranspiration=</span>mean_sum_total_evapotranspiration<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="fu">kbl</span>(df_use_for_WUE, <span class="at">caption =</span> <span class="st">"Resume of the data use for Water Use Efficiency (WUE) for eatch condition"</span>,<span class="at">col.names=</span><span class="fu">c</span>(<span class="st">"Harvest"</span>,<span class="st">"Condition"</span>, <span class="st">"Average total weight (mg)"</span>, <span class="st">"Average total evapotranspiration (ml)"</span>),<span class="at">digits =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_paper</span>(<span class="at">full_width =</span> F) <span class="sc">%&gt;%</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>   <span class="co">#column_spec(3, color = "white",background = spec_color(WUE$mean_sum_biomass, end = 0.7))%&gt;%</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>   <span class="fu">column_spec</span>(<span class="dv">4</span>, <span class="at">color =</span> <span class="st">"white"</span>,<span class="at">background =</span> <span class="fu">spec_color</span>(df_use_for_WUE<span class="sc">$</span>mean_sum_biomass, <span class="at">end =</span> <span class="fl">0.7</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-paper caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Resume of the data use for Water Use Efficiency (WUE) for eatch condition</caption>
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">Harvest</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Condition</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Average total weight (mg)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Average total evapotranspiration (ml)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: left;">Sto_WW_OT</td>
<td style="text-align: right;">89.3</td>
<td style="text-align: right; color: white !important; background-color: rgba(68, 1, 84, 255) !important;">70.2</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: left;">Wen_WW_OT</td>
<td style="text-align: right;">88.0</td>
<td style="text-align: right; color: white !important; background-color: rgba(68, 1, 84, 255) !important;">70.3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: left;">Sto_WS_HS</td>
<td style="text-align: right;">287.8</td>
<td style="text-align: right; color: white !important; background-color: rgba(71, 42, 122, 255) !important;">498.7</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: left;">Sto_WS_OT</td>
<td style="text-align: right;">471.0</td>
<td style="text-align: right; color: white !important; background-color: rgba(62, 75, 137, 255) !important;">446.1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: left;">Sto_WW_HS</td>
<td style="text-align: right;">1050.2</td>
<td style="text-align: right; color: white !important; background-color: rgba(31, 160, 136, 255) !important;">1750.4</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: left;">Sto_WW_OT</td>
<td style="text-align: right;">1195.4</td>
<td style="text-align: right; color: white !important; background-color: rgba(47, 180, 124, 255) !important;">1569.4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: left;">Wen_WS_HS</td>
<td style="text-align: right;">360.1</td>
<td style="text-align: right; color: white !important; background-color: rgba(69, 56, 129, 255) !important;">484.3</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: left;">Wen_WS_OT</td>
<td style="text-align: right;">527.9</td>
<td style="text-align: right; color: white !important; background-color: rgba(58, 84, 140, 255) !important;">449.2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: left;">Wen_WW_HS</td>
<td style="text-align: right;">1281.2</td>
<td style="text-align: right; color: white !important; background-color: rgba(67, 191, 113, 255) !important;">1863.1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: left;">Wen_WW_OT</td>
<td style="text-align: right;">1260.7</td>
<td style="text-align: right; color: white !important; background-color: rgba(63, 188, 115, 255) !important;">1608.1</td>
</tr>
</tbody>
</table>


</div>
</div>
<section id="wue-with-mean-in-h1-and-h2" class="level3" data-number="3.4.1">
<h3 data-number="3.4.1" class="anchored" data-anchor-id="wue-with-mean-in-h1-and-h2"><span class="header-section-number">3.4.1</span> WUE with mean in H1 and H2</h3>
<p>Water Use Efficiency, Thesis Couchoud (p69): Stomata closure may not be complete, transpiration is then more reduced than the net assimilation of atmospheric CO2 by photosynthesis. An increase in water use efficiency (WUE) is then observed (Maury et al., 2011). This change in WUE in response to water stress has been reported in multiple studies and high WUE is commonly associated with better tolerance to water stress (Chaves et al., 2003, 2009; Siopongco et al., 2006; Xu et al., 2010; Anjum et al., 2011; Erice et al., 2011).</p>
<p>Water Use Efficiency (WUE) between date t1 and t2 was calculated as the ratio of the plant biomass (BM) accumulated over the amount of water evapotranspirated by the plant during this period (QH2O) and is expressed in g. gH2O-1:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Process to calcul</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>WUE2mean<span class="ot">=</span>df_use_for_WUE</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>WUE2mean<span class="sc">$</span>result_WUE<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(WUE2mean)){</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(WUE2mean)){</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (WUE2mean<span class="sc">$</span>recolte[i]<span class="sc">==</span><span class="dv">1</span>){</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>      WUE2mean<span class="sc">$</span>result_WUE[i]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    }<span class="cf">else</span> <span class="cf">if</span> (WUE2mean<span class="sc">$</span>recolte[i]<span class="sc">==</span><span class="dv">2</span> <span class="sc">&amp;&amp;</span> WUE2mean<span class="sc">$</span>recolte[j]<span class="sc">==</span><span class="dv">1</span>){</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">str_sub</span>(WUE2mean<span class="sc">$</span>condition[i], <span class="dv">1</span>, <span class="dv">3</span>)<span class="sc">==</span><span class="fu">str_sub</span>(WUE2mean<span class="sc">$</span>condition[j], <span class="dv">1</span>, <span class="dv">3</span>)){</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>        WUE2mean<span class="sc">$</span>result_WUE[i]<span class="ot">=</span>(WUE2mean<span class="sc">$</span>mean_sum_biomass[i]<span class="sc">/</span><span class="dv">1000</span><span class="sc">-</span>WUE2mean<span class="sc">$</span>mean_sum_biomass[j]<span class="sc">/</span><span class="dv">1000</span>)<span class="sc">/</span>(((WUE2mean<span class="sc">$</span>mean_sum_total_evapotranspiration[i]<span class="sc">/</span><span class="dv">1000</span>))<span class="sc">-</span>((WUE2mean<span class="sc">$</span>mean_sum_total_evapotranspiration[j]<span class="sc">/</span><span class="dv">1000</span>)))</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(WUE2mean,here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/water/weighing_watering_output/WUE_with_mean_h1_and_mean_h2.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show table</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/water/weighing_watering_output/WUE_with_mean_h1_and_mean_h2.csv"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">select</span>(recolte,condition,mean_sum_biomass, mean_sum_total_evapotranspiration, result_WUE) <span class="sc">%&gt;%</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">mean_sum_biomass=</span>mean_sum_biomass<span class="sc">/</span><span class="dv">1000</span>,<span class="at">mean_sum_total_evapotranspiration=</span>(mean_sum_total_evapotranspiration<span class="sc">/</span><span class="dv">1000</span>),<span class="at">result_WUE=</span>result_WUE) <span class="sc">%&gt;%</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"WUE for eatch condition. Only mean using"</span>,<span class="at">col.names=</span><span class="fu">c</span>(<span class="st">"Harvest"</span>,<span class="st">"Condition"</span>, <span class="st">"Dry weight total (g)"</span>, <span class="st">"Sum of the evapotranspiration (L)"</span>, <span class="st">"WUE (g. L H20-1)"</span>), <span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="fu">kable_paper</span>(<span class="at">full_width =</span> F) <span class="sc">%&gt;%</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="fu">column_spec</span>(<span class="dv">5</span>, <span class="at">color =</span> <span class="st">"white"</span>,<span class="at">background =</span> <span class="fu">spec_color</span>(<span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/water/weighing_watering_output/WUE_with_mean_h1_and_mean_h2.csv"</span>)) <span class="sc">%&gt;%</span>                                                         <span class="fu">pull</span>(result_WUE), <span class="at">end =</span> <span class="fl">0.7</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-paper caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<caption>WUE for eatch condition. Only mean using</caption>
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">Harvest</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Condition</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Dry weight total (g)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Sum of the evapotranspiration (L)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">WUE (g. L H20-1)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: left;">Sto_WW_OT</td>
<td style="text-align: right;">0.09</td>
<td style="text-align: right;">0.07</td>
<td style="text-align: right; color: white !important; background-color: rgba(187, 187, 187, 255) !important;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: left;">Wen_WW_OT</td>
<td style="text-align: right;">0.09</td>
<td style="text-align: right;">0.07</td>
<td style="text-align: right; color: white !important; background-color: rgba(187, 187, 187, 255) !important;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: left;">Sto_WS_HS</td>
<td style="text-align: right;">0.29</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right; color: white !important; background-color: rgba(68, 1, 84, 255) !important;">0.46</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: left;">Sto_WS_OT</td>
<td style="text-align: right;">0.47</td>
<td style="text-align: right;">0.45</td>
<td style="text-align: right; color: white !important; background-color: rgba(30, 157, 137, 255) !important;">1.02</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: left;">Sto_WW_HS</td>
<td style="text-align: right;">1.05</td>
<td style="text-align: right;">1.75</td>
<td style="text-align: right; color: white !important; background-color: rgba(72, 40, 120, 255) !important;">0.57</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: left;">Sto_WW_OT</td>
<td style="text-align: right;">1.20</td>
<td style="text-align: right;">1.57</td>
<td style="text-align: right; color: white !important; background-color: rgba(56, 89, 140, 255) !important;">0.74</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: left;">Wen_WS_HS</td>
<td style="text-align: right;">0.36</td>
<td style="text-align: right;">0.48</td>
<td style="text-align: right; color: white !important; background-color: rgba(65, 66, 135, 255) !important;">0.66</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: left;">Wen_WS_OT</td>
<td style="text-align: right;">0.53</td>
<td style="text-align: right;">0.45</td>
<td style="text-align: right; color: white !important; background-color: rgba(67, 191, 113, 255) !important;">1.16</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: left;">Wen_WW_HS</td>
<td style="text-align: right;">1.28</td>
<td style="text-align: right;">1.86</td>
<td style="text-align: right; color: white !important; background-color: rgba(64, 69, 136, 255) !important;">0.67</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: left;">Wen_WW_OT</td>
<td style="text-align: right;">1.26</td>
<td style="text-align: right;">1.61</td>
<td style="text-align: right; color: white !important; background-color: rgba(53, 95, 141, 255) !important;">0.76</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="wue-and-srwu-h1-mean" class="level3" data-number="3.4.2">
<h3 data-number="3.4.2" class="anchored" data-anchor-id="wue-and-srwu-h1-mean"><span class="header-section-number">3.4.2</span> WUE and sRWU (H1 mean )</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data importation and preparation for H1 and H2</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>df_H1_mean<span class="ot">&lt;-</span><span class="fu">merge</span>(sum_evapo_end <span class="sc">%&gt;%</span> <span class="fu">filter</span>(recolte<span class="sc">==</span><span class="dv">1</span>),<span class="fu">read.csv2</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/physio/global_physio.csv"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>              dplyr<span class="sc">::</span><span class="fu">select</span>(plant_id, weight_root,sum_biomass, plant_num,genotype,date_recolte,recolte) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(recolte<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>recolte),<span class="at">by=</span><span class="st">"plant_id"</span>, <span class="at">all=</span>T) <span class="sc">%&gt;%</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>              <span class="fu">drop_na</span>(weight_root,sum_total_evapotranspiration) <span class="sc">%&gt;%</span> </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sum_total_evapotranspiration=</span>sum_total_evapotranspiration<span class="sc">/</span><span class="dv">1000</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(condition, genotype,recolte,date_recolte) <span class="sc">%&gt;%</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="fu">across</span>(sum_total_evapotranspiration<span class="sc">:</span>sum_biomass, <span class="sc">~</span> <span class="fu">mean</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename_all</span>(<span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_H1"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">genotype=</span>genotype_H1)</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>df_H2<span class="ot">&lt;-</span><span class="fu">merge</span>(sum_evapo_end <span class="sc">%&gt;%</span> <span class="fu">filter</span>(recolte<span class="sc">==</span><span class="dv">2</span>),<span class="fu">read.csv2</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/physio/global_physio.csv"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>              dplyr<span class="sc">::</span><span class="fu">select</span>(plant_id, weight_root,sum_biomass, plant_num,genotype,date_recolte,recolte) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(recolte<span class="sc">==</span><span class="dv">2</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>recolte),<span class="at">by=</span><span class="st">"plant_id"</span>, <span class="at">all=</span>T) <span class="sc">%&gt;%</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>              <span class="fu">drop_na</span>(weight_root,sum_total_evapotranspiration) <span class="sc">%&gt;%</span> </span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sum_total_evapotranspiration=</span>sum_total_evapotranspiration<span class="sc">/</span><span class="dv">1000</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename_all</span>(<span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">"_H2"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">genotype=</span>genotype_H2)</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Process WUE and sRWU</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>WUE_sRWU_1mean<span class="ot">=</span><span class="fu">full_join</span>(df_H2, df_H1_mean, <span class="at">by=</span><span class="st">"genotype"</span>,<span class="at">relationship =</span> <span class="st">"many-to-many"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">WUE=</span>(sum_biomass_H2 <span class="sc">-</span>sum_biomass_H1)<span class="sc">/</span>(sum_total_evapotranspiration_H2 <span class="sc">-</span>sum_total_evapotranspiration_H1)) <span class="sc">%&gt;%</span> </span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sRWU=</span>(sum_total_evapotranspiration_H2<span class="sc">-</span>sum_total_evapotranspiration_H1)<span class="sc">/</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>      (( (<span class="fu">as.numeric</span>(<span class="fu">as.Date</span>(date_recolte_H2)<span class="sc">-</span><span class="fu">as.Date</span>(date_recolte_H1))) <span class="sc">*</span> ((weight_root_H2<span class="sc">+</span>weight_root_H1)<span class="sc">/</span><span class="dv">2</span>) ))) <span class="sc">%&gt;%</span> </span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">condition=</span>condition_H2) <span class="sc">%&gt;%</span> </span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">water_condition=</span><span class="fu">str_sub</span>(condition, <span class="dv">5</span>, <span class="dv">6</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">heat_condition=</span><span class="fu">str_sub</span>(condition, <span class="dv">8</span>, <span class="dv">9</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">climat_condition=</span><span class="fu">paste0</span>(water_condition, <span class="st">"_"</span>, heat_condition)) <span class="sc">%&gt;%</span> </span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">condition=</span><span class="fu">factor</span>(condition,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">"Sto_WW_OT"</span>,<span class="st">"Sto_WS_OT"</span>,<span class="st">"Sto_WW_HS"</span>,<span class="st">"Sto_WS_HS"</span>,<span class="st">"Wen_WW_OT"</span>,<span class="st">"Wen_WS_OT"</span>,<span class="st">"Wen_WW_HS"</span>,<span class="st">"Wen_WS_HS"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">climat_condition=</span><span class="fu">factor</span>(climat_condition,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">"WW_OT"</span>,<span class="st">"WS_OT"</span>,<span class="st">"WW_HS"</span>,<span class="st">"WS_HS"</span>)))</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a><span class="co"># export results</span></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(WUE_sRWU_1mean,here<span class="sc">::</span><span class="fu">here</span>(<span class="fu">paste</span>(<span class="at">sep=</span><span class="st">"_"</span>,<span class="st">"data/water/weighing_watering_output/WUE_sRWU_1mean.csv"</span>)))</span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Show results</span></span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>pWUE<span class="ot">=</span><span class="fu">stat_analyse</span>(<span class="at">data =</span>WUE_sRWU_1mean,</span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>                <span class="at">column_value =</span> <span class="st">"WUE"</span>,</span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>                <span class="at">category_variables =</span> <span class="fu">c</span>(<span class="st">"climat_condition"</span>),</span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a>                <span class="at">grp_var =</span> <span class="st">"genotype"</span>,</span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a>                <span class="at">control_conditions =</span> <span class="fu">c</span>(<span class="st">"WW_OT"</span>),</span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a>                <span class="at">biologist_stats =</span> T,</span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a>                <span class="at">strip_normale =</span> F,</span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>                <span class="at">outlier_show =</span> F,</span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a>                <span class="at">label_outlier =</span> <span class="st">"plant_num_H2"</span>,</span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a>                <span class="at">show_plot =</span> T,</span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a>                <span class="at">hex_pallet =</span> climate_pallet,</span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a>                <span class="at">Ylab_i =</span> <span class="fu">paste0</span>(<span class="st">"Water Use Efficiency (g/L)"</span>)</span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-49"><a href="#cb18-49" aria-hidden="true" tabindex="-1"></a>pWUE<span class="ot">&lt;-</span>pWUE[[<span class="st">"plot"</span>]]<span class="sc">+</span><span class="fu">labs</span>(<span class="at">color=</span><span class="st">"Treatment"</span>,<span class="at">fill=</span><span class="st">"Treatment"</span>)<span class="sc">+</span></span>
<span id="cb18-50"><a href="#cb18-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb18-51"><a href="#cb18-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb18-52"><a href="#cb18-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb18-53"><a href="#cb18-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb18-54"><a href="#cb18-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>()</span>
<span id="cb18-55"><a href="#cb18-55" aria-hidden="true" tabindex="-1"></a>        )<span class="sc">+</span><span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">"WUE with one mean"</span>)</span>
<span id="cb18-56"><a href="#cb18-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-57"><a href="#cb18-57" aria-hidden="true" tabindex="-1"></a><span class="co"># Show results</span></span>
<span id="cb18-58"><a href="#cb18-58" aria-hidden="true" tabindex="-1"></a>psRWU<span class="ot">=</span><span class="fu">stat_analyse</span>(<span class="at">data =</span>WUE_sRWU_1mean,</span>
<span id="cb18-59"><a href="#cb18-59" aria-hidden="true" tabindex="-1"></a>                <span class="at">column_value =</span> <span class="st">"sRWU"</span>,</span>
<span id="cb18-60"><a href="#cb18-60" aria-hidden="true" tabindex="-1"></a>                <span class="at">category_variables =</span> <span class="fu">c</span>(<span class="st">"climat_condition"</span>),</span>
<span id="cb18-61"><a href="#cb18-61" aria-hidden="true" tabindex="-1"></a>                <span class="at">grp_var =</span> <span class="st">"genotype"</span>,</span>
<span id="cb18-62"><a href="#cb18-62" aria-hidden="true" tabindex="-1"></a>                <span class="at">control_conditions =</span> <span class="fu">c</span>(<span class="st">"WW_OT"</span>),</span>
<span id="cb18-63"><a href="#cb18-63" aria-hidden="true" tabindex="-1"></a>                <span class="at">biologist_stats =</span> T,</span>
<span id="cb18-64"><a href="#cb18-64" aria-hidden="true" tabindex="-1"></a>                <span class="at">strip_normale =</span> F,</span>
<span id="cb18-65"><a href="#cb18-65" aria-hidden="true" tabindex="-1"></a>                <span class="at">outlier_show =</span> F,</span>
<span id="cb18-66"><a href="#cb18-66" aria-hidden="true" tabindex="-1"></a>                <span class="at">label_outlier =</span> <span class="st">"plant_num_H2"</span>,</span>
<span id="cb18-67"><a href="#cb18-67" aria-hidden="true" tabindex="-1"></a>                <span class="at">show_plot =</span> T,</span>
<span id="cb18-68"><a href="#cb18-68" aria-hidden="true" tabindex="-1"></a>                <span class="at">hex_pallet =</span> climate_pallet,</span>
<span id="cb18-69"><a href="#cb18-69" aria-hidden="true" tabindex="-1"></a>                <span class="at">Ylab_i =</span> <span class="fu">paste0</span>(<span class="st">"specific Root Water Uptake (gH2O[gBMroot day-1]-1)"</span>)</span>
<span id="cb18-70"><a href="#cb18-70" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb18-71"><a href="#cb18-71" aria-hidden="true" tabindex="-1"></a>psRWU<span class="ot">&lt;-</span>psRWU[[<span class="st">"plot"</span>]]<span class="sc">+</span><span class="fu">labs</span>(<span class="at">color=</span><span class="st">"Treatment"</span>,<span class="at">fill=</span><span class="st">"Treatment"</span>)<span class="sc">+</span></span>
<span id="cb18-72"><a href="#cb18-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb18-73"><a href="#cb18-73" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb18-74"><a href="#cb18-74" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb18-75"><a href="#cb18-75" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb18-76"><a href="#cb18-76" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>()</span>
<span id="cb18-77"><a href="#cb18-77" aria-hidden="true" tabindex="-1"></a>        )<span class="sc">+</span><span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">"sRWU with one mean"</span>)</span>
<span id="cb18-78"><a href="#cb18-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-79"><a href="#cb18-79" aria-hidden="true" tabindex="-1"></a>combined_plot<span class="ot">&lt;-</span>(pWUE<span class="sc">+</span>psRWU) <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">'collect'</span>)</span>
<span id="cb18-80"><a href="#cb18-80" aria-hidden="true" tabindex="-1"></a><span class="co"># export figure</span></span>
<span id="cb18-81"><a href="#cb18-81" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="fu">paste0</span>(<span class="st">"report/water/plot/WUE_sRWU_1mean.png"</span>)), <span class="at">width =</span> <span class="dv">18</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">units =</span> <span class="st">'cm'</span>, <span class="at">res =</span> <span class="dv">900</span>)</span>
<span id="cb18-82"><a href="#cb18-82" aria-hidden="true" tabindex="-1"></a>combined_plot</span>
<span id="cb18-83"><a href="#cb18-83" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><a href="plot/WUE_sRWU_1mean.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11"><img src="plot/WUE_sRWU_1mean.png" class="img-fluid"></a></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show table</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/water/weighing_watering_output/WUE_sRWU_1mean.csv"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">select</span>(condition, WUE,sRWU) <span class="sc">%&gt;%</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(condition) <span class="sc">%&gt;%</span> </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="fu">across</span>(WUE<span class="sc">:</span>sRWU, mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"WUE and sRWU for eatch condition. Mean only for H1"</span>, <span class="at">col.names=</span><span class="fu">c</span>(<span class="st">"Condition"</span>, <span class="st">"WUE (g. L H20-1)"</span>,<span class="st">"sRWU(gH2O[gBMroot day-1]-1)"</span>), <span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="fu">kable_paper</span>(<span class="at">full_width =</span> F) <span class="sc">%&gt;%</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="fu">column_spec</span>(<span class="dv">2</span>, <span class="at">color =</span> <span class="st">"white"</span>,<span class="at">background =</span> <span class="fu">spec_color</span>(<span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/water/weighing_watering_output/WUE_sRWU_1mean.csv"</span>)) <span class="sc">%&gt;%</span>dplyr<span class="sc">::</span><span class="fu">group_by</span>(condition) <span class="sc">%&gt;%</span> </span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="fu">across</span>(WUE<span class="sc">:</span>sRWU, mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span>  <span class="fu">pull</span>(WUE), <span class="at">end =</span> <span class="fl">0.7</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="fu">column_spec</span>(<span class="dv">3</span>, <span class="at">color =</span> <span class="st">"white"</span>,<span class="at">background =</span> <span class="fu">spec_color</span>(<span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/water/weighing_watering_output/WUE_sRWU_1mean.csv"</span>)) <span class="sc">%&gt;%</span>dplyr<span class="sc">::</span><span class="fu">group_by</span>(condition) <span class="sc">%&gt;%</span> </span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="fu">across</span>(WUE<span class="sc">:</span>sRWU, mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span>  <span class="fu">pull</span>(sRWU), <span class="at">end =</span> <span class="fl">0.7</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-paper caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<caption>WUE and sRWU for eatch condition. Mean only for H1</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Condition</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">WUE (g. L H20-1)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sRWU(gH2O[gBMroot day-1]-1)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Sto_WS_HS</td>
<td style="text-align: right; color: white !important; background-color: rgba(68, 1, 84, 255) !important;">0.47</td>
<td style="text-align: right; color: white !important; background-color: rgba(49, 104, 142, 255) !important;">0.66</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sto_WS_OT</td>
<td style="text-align: right; color: white !important; background-color: rgba(30, 156, 137, 255) !important;">1.03</td>
<td style="text-align: right; color: white !important; background-color: rgba(71, 14, 97, 255) !important;">0.35</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sto_WW_HS</td>
<td style="text-align: right; color: white !important; background-color: rgba(72, 36, 117, 255) !important;">0.57</td>
<td style="text-align: right; color: white !important; background-color: rgba(67, 191, 113, 255) !important;">1.03</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sto_WW_OT</td>
<td style="text-align: right; color: white !important; background-color: rgba(58, 85, 140, 255) !important;">0.74</td>
<td style="text-align: right; color: white !important; background-color: rgba(40, 124, 142, 255) !important;">0.74</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Wen_WS_HS</td>
<td style="text-align: right; color: white !important; background-color: rgba(66, 64, 134, 255) !important;">0.67</td>
<td style="text-align: right; color: white !important; background-color: rgba(62, 73, 137, 255) !important;">0.54</td>
</tr>
<tr class="even">
<td style="text-align: left;">Wen_WS_OT</td>
<td style="text-align: right; color: white !important; background-color: rgba(67, 191, 113, 255) !important;">1.18</td>
<td style="text-align: right; color: white !important; background-color: rgba(68, 1, 84, 255) !important;">0.32</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Wen_WW_HS</td>
<td style="text-align: right; color: white !important; background-color: rgba(67, 62, 133, 255) !important;">0.65</td>
<td style="text-align: right; color: white !important; background-color: rgba(48, 181, 123, 255) !important;">0.98</td>
</tr>
<tr class="even">
<td style="text-align: left;">Wen_WW_OT</td>
<td style="text-align: right; color: white !important; background-color: rgba(53, 94, 141, 255) !important;">0.77</td>
<td style="text-align: right; color: white !important; background-color: rgba(38, 130, 142, 255) !important;">0.77</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="wue-and-srwu-drawing-with-discount" class="level3" data-number="3.4.3">
<h3 data-number="3.4.3" class="anchored" data-anchor-id="wue-and-srwu-drawing-with-discount"><span class="header-section-number">3.4.3</span> WUE and sRWU (Drawing with discount )</h3>
<p>Now according to Marion, I have to do random draw for statistical analysis <em>see script used for nodosity in my first paper</em>. I have a repetition of the draw of 100 for eatch condition according to Denis Vile. The problem is that I have lots of data warning of different df. Already only one measurement for root weight. So I have to halve the evapotranspiration because I don‚Äôt know which RT plant it is.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data generation</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>df_WUE_sRWU_bootstrap<span class="ot">=</span><span class="fu">merge</span>(sum_evapo_end,<span class="fu">read.csv2</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/physio/global_physio.csv"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>              dplyr<span class="sc">::</span><span class="fu">select</span>(plant_id, weight_root,sum_biomass, plant_num,genotype,date_recolte),<span class="at">by=</span><span class="st">"plant_id"</span>, <span class="at">all=</span>T ) <span class="sc">%&gt;%</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>              <span class="fu">drop_na</span>(weight_root,sum_total_evapotranspiration) <span class="sc">%&gt;%</span> </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sum_total_evapotranspiration=</span>sum_total_evapotranspiration<span class="sc">/</span><span class="dv">1000</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Process to bootstrap</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>list_condition<span class="ot">&lt;-</span><span class="fu">levels</span>(<span class="fu">as.factor</span>(df_WUE_sRWU_bootstrap<span class="sc">$</span>condition))</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="do">### parameter  </span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>rep<span class="ot">=</span><span class="dv">100</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>df_bootstrap<span class="ot">=</span><span class="fu">data.frame</span>()</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="co">#For eatch condition of the harvest 2</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>rep){</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (cond_x <span class="cf">in</span> list_condition){</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>    df_x<span class="ot">=</span>df_WUE_sRWU_bootstrap <span class="sc">%&gt;%</span> <span class="fu">filter</span>(recolte<span class="sc">==</span><span class="st">"2"</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(condition<span class="sc">==</span>cond_x)</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>    df_x_taking<span class="ot">=</span>df_x <span class="sc">%&gt;%</span> <span class="fu">filter</span>(plant_num<span class="sc">==</span><span class="fu">sample</span>(df_x<span class="sc">$</span>plant_num,<span class="dv">1</span>,<span class="at">replace=</span>T)) </span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">str_sub</span>(df_x_taking<span class="sc">$</span>condition, <span class="dv">1</span>, <span class="dv">3</span>)<span class="sc">==</span><span class="st">"Sto"</span>){</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>      df_y<span class="ot">=</span>df_wue <span class="sc">%&gt;%</span> <span class="fu">filter</span>(recolte<span class="sc">==</span><span class="st">"1"</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(genotype<span class="sc">==</span><span class="st">"Stocata"</span>)</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>    }<span class="cf">else</span> {</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>      df_y<span class="ot">=</span>df_wue <span class="sc">%&gt;%</span> <span class="fu">filter</span>(recolte<span class="sc">==</span><span class="st">"1"</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(genotype<span class="sc">==</span><span class="st">"Wendy"</span>)</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>    df_y_taking<span class="ot">=</span>df_y <span class="sc">%&gt;%</span> <span class="fu">filter</span>(plant_num<span class="sc">==</span><span class="fu">sample</span>(df_y<span class="sc">$</span>plant_num,<span class="dv">1</span>,<span class="at">replace=</span>T)) </span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colnames</span>(df_x_taking)<span class="ot">=</span><span class="fu">c</span>(<span class="st">"plant_id_rec_2"</span>,<span class="st">"condition"</span>,<span class="st">"recolte_2"</span>,<span class="st">"sum_evapo_transpi_2"</span>,<span class="st">"weight_root_2"</span>,<span class="st">"weight_tot_2"</span>,<span class="st">"plant_num_2"</span>,<span class="st">"genotype_2"</span>,<span class="st">"date_recolte_2"</span>)</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colnames</span>(df_y_taking)<span class="ot">=</span><span class="fu">c</span>(<span class="st">"plant_id_rec_1"</span>,<span class="st">"condition1"</span>,<span class="st">"recolte_1"</span>,<span class="st">"sum_evapo_transpi_1"</span>,<span class="st">"weight_root_1"</span>,<span class="st">"weight_tot_1"</span>,<span class="st">"plant_num_1"</span>,<span class="st">"genotype_1"</span>,<span class="st">"date_recolte_1"</span>)</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>    df_bind<span class="ot">=</span><span class="fu">cbind</span>(df_y_taking,df_x_taking)</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>    df_bind<span class="sc">$</span>rep<span class="ot">=</span>i</span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>    df_bind<span class="sc">$</span>simulation<span class="ot">=</span><span class="fu">paste0</span>(i,<span class="st">"_"</span>,cond_x)</span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>    df_bind<span class="sc">$</span>WUE<span class="ot">=</span>(df_bind<span class="sc">$</span>weight_tot_2<span class="sc">-</span>df_bind<span class="sc">$</span>weight_tot_1)<span class="sc">/</span>(df_bind<span class="sc">$</span>sum_evapo_transpi_2<span class="sc">-</span>df_bind<span class="sc">$</span>sum_evapo_transpi_1)</span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>    df_bind<span class="sc">$</span>sRWU<span class="ot">=</span>(df_bind<span class="sc">$</span>sum_evapo_transpi_2<span class="sc">-</span>df_bind<span class="sc">$</span>sum_evapo_transpi_1)<span class="sc">/</span></span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>      (( (<span class="fu">as.numeric</span>(<span class="fu">as.Date</span>(df_bind<span class="sc">$</span>date_recolte_2)<span class="sc">-</span><span class="fu">as.Date</span>(df_bind<span class="sc">$</span>date_recolte_1))) <span class="sc">*</span> ((df_bind<span class="sc">$</span>weight_root_2<span class="sc">+</span>df_bind<span class="sc">$</span>weight_root_1)<span class="sc">/</span><span class="dv">2</span>) ))</span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a>    <span class="co">#print(str_sub(df_x_taking$condition, 1, 3))</span></span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a>    df_bootstrap<span class="ot">=</span><span class="fu">rbind</span>(df_bootstrap,df_bind)</span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">aov</span>(WUE <span class="sc">~</span> condition, df_compile)<span class="co"># analyse de variance</span></span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(fit)[[<span class="dv">1</span>]][[<span class="st">"Pr(&gt;F)"</span>]][<span class="dv">1</span>]) ; </span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-46"><a href="#cb20-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Obviously the more loops i make the stronger i am !!! </span></span>
<span id="cb20-47"><a href="#cb20-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-48"><a href="#cb20-48" aria-hidden="true" tabindex="-1"></a>df_bootstrap<span class="ot">=</span>df_bootstrap <span class="sc">%&gt;%</span> </span>
<span id="cb20-49"><a href="#cb20-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">water_condition=</span><span class="fu">str_sub</span>(condition, <span class="dv">5</span>, <span class="dv">6</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb20-50"><a href="#cb20-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">heat_condition=</span><span class="fu">str_sub</span>(condition, <span class="dv">8</span>, <span class="dv">9</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb20-51"><a href="#cb20-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">climat_condition=</span><span class="fu">paste0</span>(water_condition, <span class="st">"_"</span>, heat_condition)) <span class="sc">%&gt;%</span> </span>
<span id="cb20-52"><a href="#cb20-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">condition=</span><span class="fu">factor</span>(condition,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">"Sto_WW_OT"</span>,<span class="st">"Sto_WS_OT"</span>,<span class="st">"Sto_WW_HS"</span>,<span class="st">"Sto_WS_HS"</span>,<span class="st">"Wen_WW_OT"</span>,<span class="st">"Wen_WS_OT"</span>,<span class="st">"Wen_WW_HS"</span>,<span class="st">"Wen_WS_HS"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb20-53"><a href="#cb20-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">climat_condition=</span><span class="fu">factor</span>(climat_condition,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">"WW_OT"</span>,<span class="st">"WS_OT"</span>,<span class="st">"WW_HS"</span>,<span class="st">"WS_HS"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb20-54"><a href="#cb20-54" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">genotype=</span>genotype_2)</span>
<span id="cb20-55"><a href="#cb20-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-56"><a href="#cb20-56" aria-hidden="true" tabindex="-1"></a><span class="co"># export results</span></span>
<span id="cb20-57"><a href="#cb20-57" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(df_bootstrap,here<span class="sc">::</span><span class="fu">here</span>(<span class="fu">paste</span>(<span class="at">sep=</span><span class="st">"_"</span>,<span class="st">"data/water/weighing_watering_output/WUE_sRWU_Bootstrap.csv"</span>)))</span>
<span id="cb20-58"><a href="#cb20-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-59"><a href="#cb20-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Show results</span></span>
<span id="cb20-60"><a href="#cb20-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-61"><a href="#cb20-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-62"><a href="#cb20-62" aria-hidden="true" tabindex="-1"></a>pWUE<span class="ot">=</span><span class="fu">stat_analyse</span>(<span class="at">data =</span>df_bootstrap,</span>
<span id="cb20-63"><a href="#cb20-63" aria-hidden="true" tabindex="-1"></a>                <span class="at">column_value =</span> <span class="st">"WUE"</span>,</span>
<span id="cb20-64"><a href="#cb20-64" aria-hidden="true" tabindex="-1"></a>                <span class="at">category_variables =</span> <span class="fu">c</span>(<span class="st">"climat_condition"</span>),</span>
<span id="cb20-65"><a href="#cb20-65" aria-hidden="true" tabindex="-1"></a>                <span class="at">grp_var =</span> <span class="st">"genotype"</span>,</span>
<span id="cb20-66"><a href="#cb20-66" aria-hidden="true" tabindex="-1"></a>                <span class="at">control_conditions =</span> <span class="fu">c</span>(<span class="st">"WW_OT"</span>),</span>
<span id="cb20-67"><a href="#cb20-67" aria-hidden="true" tabindex="-1"></a>                <span class="at">biologist_stats =</span> T,</span>
<span id="cb20-68"><a href="#cb20-68" aria-hidden="true" tabindex="-1"></a>                <span class="at">strip_normale =</span> F,</span>
<span id="cb20-69"><a href="#cb20-69" aria-hidden="true" tabindex="-1"></a>                <span class="at">outlier_show =</span> F,</span>
<span id="cb20-70"><a href="#cb20-70" aria-hidden="true" tabindex="-1"></a>                <span class="at">label_outlier =</span> <span class="st">"simulation"</span>,</span>
<span id="cb20-71"><a href="#cb20-71" aria-hidden="true" tabindex="-1"></a>                <span class="at">show_plot =</span> T,</span>
<span id="cb20-72"><a href="#cb20-72" aria-hidden="true" tabindex="-1"></a>                <span class="at">hex_pallet =</span> climate_pallet,</span>
<span id="cb20-73"><a href="#cb20-73" aria-hidden="true" tabindex="-1"></a>                <span class="at">Ylab_i =</span> <span class="fu">paste0</span>(<span class="st">"Water Use Efficiency (g/L)"</span>)</span>
<span id="cb20-74"><a href="#cb20-74" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb20-75"><a href="#cb20-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-76"><a href="#cb20-76" aria-hidden="true" tabindex="-1"></a>pWUE<span class="ot">&lt;-</span>pWUE[[<span class="st">"plot"</span>]]<span class="sc">+</span><span class="fu">labs</span>(<span class="at">color=</span><span class="st">"Treatment"</span>,<span class="at">fill=</span><span class="st">"Treatment"</span>)<span class="sc">+</span></span>
<span id="cb20-77"><a href="#cb20-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb20-78"><a href="#cb20-78" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb20-79"><a href="#cb20-79" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb20-80"><a href="#cb20-80" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb20-81"><a href="#cb20-81" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>()</span>
<span id="cb20-82"><a href="#cb20-82" aria-hidden="true" tabindex="-1"></a>        )<span class="sc">+</span><span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">"WUE with Bootstrap = 100"</span>)</span>
<span id="cb20-83"><a href="#cb20-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-84"><a href="#cb20-84" aria-hidden="true" tabindex="-1"></a><span class="co"># Show results for sRWU</span></span>
<span id="cb20-85"><a href="#cb20-85" aria-hidden="true" tabindex="-1"></a>psRWU<span class="ot">=</span><span class="fu">stat_analyse</span>(<span class="at">data =</span>df_bootstrap,</span>
<span id="cb20-86"><a href="#cb20-86" aria-hidden="true" tabindex="-1"></a>                <span class="at">column_value =</span> <span class="st">"sRWU"</span>,</span>
<span id="cb20-87"><a href="#cb20-87" aria-hidden="true" tabindex="-1"></a>                <span class="at">category_variables =</span> <span class="fu">c</span>(<span class="st">"climat_condition"</span>),</span>
<span id="cb20-88"><a href="#cb20-88" aria-hidden="true" tabindex="-1"></a>                <span class="at">grp_var =</span> <span class="st">"genotype"</span>,</span>
<span id="cb20-89"><a href="#cb20-89" aria-hidden="true" tabindex="-1"></a>                <span class="at">control_conditions =</span> <span class="fu">c</span>(<span class="st">"WW_OT"</span>),</span>
<span id="cb20-90"><a href="#cb20-90" aria-hidden="true" tabindex="-1"></a>                <span class="at">biologist_stats =</span> T,</span>
<span id="cb20-91"><a href="#cb20-91" aria-hidden="true" tabindex="-1"></a>                <span class="at">strip_normale =</span> F,</span>
<span id="cb20-92"><a href="#cb20-92" aria-hidden="true" tabindex="-1"></a>                <span class="at">outlier_show =</span> F,</span>
<span id="cb20-93"><a href="#cb20-93" aria-hidden="true" tabindex="-1"></a>                <span class="at">label_outlier =</span> <span class="st">"simulation"</span>,</span>
<span id="cb20-94"><a href="#cb20-94" aria-hidden="true" tabindex="-1"></a>                <span class="at">show_plot =</span> T,</span>
<span id="cb20-95"><a href="#cb20-95" aria-hidden="true" tabindex="-1"></a>                <span class="at">hex_pallet =</span> climate_pallet,</span>
<span id="cb20-96"><a href="#cb20-96" aria-hidden="true" tabindex="-1"></a>                <span class="at">Ylab_i =</span> <span class="fu">paste0</span>(<span class="st">"specific Root Water Uptake (gH2O[gBMroot day-1]-1)"</span>)</span>
<span id="cb20-97"><a href="#cb20-97" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb20-98"><a href="#cb20-98" aria-hidden="true" tabindex="-1"></a>psRWU<span class="ot">&lt;-</span>psRWU[[<span class="st">"plot"</span>]]<span class="sc">+</span><span class="fu">labs</span>(<span class="at">color=</span><span class="st">"Treatment"</span>,<span class="at">fill=</span><span class="st">"Treatment"</span>)<span class="sc">+</span></span>
<span id="cb20-99"><a href="#cb20-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb20-100"><a href="#cb20-100" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb20-101"><a href="#cb20-101" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb20-102"><a href="#cb20-102" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb20-103"><a href="#cb20-103" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>()</span>
<span id="cb20-104"><a href="#cb20-104" aria-hidden="true" tabindex="-1"></a>        )<span class="sc">+</span><span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">"sRWU with Bootstrap =100"</span>)</span>
<span id="cb20-105"><a href="#cb20-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-106"><a href="#cb20-106" aria-hidden="true" tabindex="-1"></a>combined_plot<span class="ot">&lt;-</span>(pWUE<span class="sc">+</span>psRWU) <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">'collect'</span>)</span>
<span id="cb20-107"><a href="#cb20-107" aria-hidden="true" tabindex="-1"></a><span class="co"># export figure</span></span>
<span id="cb20-108"><a href="#cb20-108" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="fu">paste0</span>(<span class="st">"report/water/plot/WUE_sRWU_Bootstrap.png"</span>)), <span class="at">width =</span> <span class="dv">18</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">units =</span> <span class="st">'cm'</span>, <span class="at">res =</span> <span class="dv">900</span>)</span>
<span id="cb20-109"><a href="#cb20-109" aria-hidden="true" tabindex="-1"></a>combined_plot</span>
<span id="cb20-110"><a href="#cb20-110" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><a href="plot/WUE_sRWU_Bootstrap.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12"><img src="plot/WUE_sRWU_Bootstrap.png" class="img-fluid"></a></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show table</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/water/weighing_watering_output/WUE_sRWU_Bootstrap.csv"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">select</span>(condition, WUE,sRWU) <span class="sc">%&gt;%</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(condition) <span class="sc">%&gt;%</span> </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="fu">across</span>(WUE<span class="sc">:</span>sRWU, mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"WUE and sRWU for eatch condition. Bootstrap = 100"</span>, <span class="at">col.names=</span><span class="fu">c</span>(<span class="st">"Condition"</span>, <span class="st">"WUE (g. L H20-1)"</span>,<span class="st">"sRWU(gH2O[gBMroot day-1]-1)"</span>), <span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="fu">kable_paper</span>(<span class="at">full_width =</span> F) <span class="sc">%&gt;%</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="fu">column_spec</span>(<span class="dv">2</span>, <span class="at">color =</span> <span class="st">"white"</span>,<span class="at">background =</span> <span class="fu">spec_color</span>(<span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/water/weighing_watering_output/WUE_sRWU_Bootstrap.csv"</span>)) <span class="sc">%&gt;%</span>dplyr<span class="sc">::</span><span class="fu">group_by</span>(condition) <span class="sc">%&gt;%</span> </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="fu">across</span>(WUE<span class="sc">:</span>sRWU, mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span>  <span class="fu">pull</span>(WUE), <span class="at">end =</span> <span class="fl">0.7</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="fu">column_spec</span>(<span class="dv">3</span>, <span class="at">color =</span> <span class="st">"white"</span>,<span class="at">background =</span> <span class="fu">spec_color</span>(<span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/water/weighing_watering_output/WUE_sRWU_Bootstrap.csv"</span>)) <span class="sc">%&gt;%</span>dplyr<span class="sc">::</span><span class="fu">group_by</span>(condition) <span class="sc">%&gt;%</span> </span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="fu">across</span>(WUE<span class="sc">:</span>sRWU, mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span>  <span class="fu">pull</span>(sRWU), <span class="at">end =</span> <span class="fl">0.7</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-paper caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<caption>WUE and sRWU for eatch condition. Bootstrap = 100</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Condition</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">WUE (g. L H20-1)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sRWU(gH2O[gBMroot day-1]-1)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Sto_WS_HS</td>
<td style="text-align: right; color: white !important; background-color: rgba(68, 1, 84, 255) !important;">0.49</td>
<td style="text-align: right; color: white !important; background-color: rgba(48, 105, 142, 255) !important;">0.66</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sto_WS_OT</td>
<td style="text-align: right; color: white !important; background-color: rgba(35, 169, 131, 255) !important;">1.04</td>
<td style="text-align: right; color: white !important; background-color: rgba(71, 12, 95, 255) !important;">0.36</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sto_WW_HS</td>
<td style="text-align: right; color: white !important; background-color: rgba(72, 35, 116, 255) !important;">0.58</td>
<td style="text-align: right; color: white !important; background-color: rgba(67, 191, 113, 255) !important;">1.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sto_WW_OT</td>
<td style="text-align: right; color: white !important; background-color: rgba(55, 90, 140, 255) !important;">0.75</td>
<td style="text-align: right; color: white !important; background-color: rgba(42, 120, 142, 255) !important;">0.71</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Wen_WS_HS</td>
<td style="text-align: right; color: white !important; background-color: rgba(66, 64, 134, 255) !important;">0.67</td>
<td style="text-align: right; color: white !important; background-color: rgba(62, 73, 137, 255) !important;">0.54</td>
</tr>
<tr class="even">
<td style="text-align: left;">Wen_WS_OT</td>
<td style="text-align: right; color: white !important; background-color: rgba(67, 191, 113, 255) !important;">1.13</td>
<td style="text-align: right; color: white !important; background-color: rgba(68, 1, 84, 255) !important;">0.33</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Wen_WW_HS</td>
<td style="text-align: right; color: white !important; background-color: rgba(68, 58, 131, 255) !important;">0.65</td>
<td style="text-align: right; color: white !important; background-color: rgba(64, 189, 114, 255) !important;">1.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Wen_WW_OT</td>
<td style="text-align: right; color: white !important; background-color: rgba(54, 93, 141, 255) !important;">0.76</td>
<td style="text-align: right; color: white !important; background-color: rgba(37, 133, 142, 255) !important;">0.77</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
</section>
<section id="evapo-surface" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="evapo-surface"><span class="header-section-number">3.5</span> Evapo / Surface</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>sum_evapo_end_and_physio<span class="ot">=</span> <span class="fu">full_join</span>(<span class="fu">read.csv2</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/water/weighing_watering_output/sum_evapotranspi.csv"</span>), <span class="at">sep=</span><span class="st">","</span>,<span class="at">dec=</span><span class="st">"."</span>)[<span class="sc">-</span><span class="dv">1</span>],<span class="fu">read.csv2</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/physio/global_physio.csv"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>                                      dplyr<span class="sc">::</span><span class="fu">select</span>(plant_id,plant_num, weight_root, leaf_area,sum_biomass),  <span class="at">by=</span><span class="st">"plant_id"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sum_total_evapotranspiration=</span>sum_total_evapotranspiration<span class="sc">/</span><span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(leaf_area,sum_total_evapotranspiration) <span class="sc">%&gt;%</span> </span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">evapo_surface=</span>sum_total_evapotranspiration<span class="sc">/</span>leaf_area) <span class="sc">%&gt;%</span> </span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">water_condition=</span><span class="fu">str_sub</span>(condition, <span class="dv">5</span>, <span class="dv">6</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">heat_condition=</span><span class="fu">str_sub</span>(condition, <span class="dv">8</span>, <span class="dv">9</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">climat_condition=</span><span class="fu">paste0</span>(water_condition, <span class="st">"_"</span>, heat_condition)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">condition=</span><span class="fu">factor</span>(condition,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">"Sto_WW_OT"</span>,<span class="st">"Sto_WS_OT"</span>,<span class="st">"Sto_WW_HS"</span>,<span class="st">"Sto_WS_HS"</span>,<span class="st">"Wen_WW_OT"</span>,<span class="st">"Wen_WS_OT"</span>,<span class="st">"Wen_WW_HS"</span>,<span class="st">"Wen_WS_HS"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">climat_condition=</span><span class="fu">factor</span>(climat_condition,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">"WW_OT"</span>,<span class="st">"WS_OT"</span>,<span class="st">"WW_HS"</span>,<span class="st">"WS_HS"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">genotype=</span><span class="fu">ifelse</span>(<span class="fu">str_sub</span>(condition, <span class="dv">1</span>, <span class="dv">3</span>)<span class="sc">==</span><span class="st">"Sto"</span>,<span class="st">"Stocata"</span>,<span class="st">"Wendy"</span>))  </span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>sum_evapo_end_and_physio_H1<span class="ot">=</span>sum_evapo_end_and_physio <span class="sc">%&gt;%</span> </span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(recolte<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>sum_evapo_end_and_physio_H2<span class="ot">=</span>sum_evapo_end_and_physio <span class="sc">%&gt;%</span> </span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(recolte<span class="sc">==</span><span class="dv">2</span>)</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a><span class="co">#creation of table</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>sum_evapo_end_and_physio_H2 <span class="sc">%&gt;%</span> </span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">select</span>(condition, sum_total_evapotranspiration, leaf_area,evapo_surface) <span class="sc">%&gt;%</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(condition) <span class="sc">%&gt;%</span> </span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="fu">across</span>(sum_total_evapotranspiration <span class="sc">:</span> evapo_surface, <span class="fu">list</span>(mean,sd), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a><span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Evapotranspiration by surface of leaf (Mean)"</span>, <span class="at">col.names=</span><span class="fu">c</span>(<span class="st">"Condition"</span>, <span class="st">"Evapotranspiration total during the experiment (mL)"</span>, <span class="st">"sd"</span>,<span class="st">"Leaf area (cm¬≤)"</span>, <span class="st">"sd"</span>, <span class="st">"Evapo / Leaf surface area (g/cm¬≤)"</span>, <span class="st">"sd"</span>), <span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a><span class="fu">kable_paper</span>(<span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>px_H2<span class="ot">=</span><span class="fu">stat_analyse</span>(<span class="at">data =</span>sum_evapo_end_and_physio_H2,</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">column_value =</span> <span class="st">"evapo_surface"</span>,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">category_variables =</span> <span class="fu">c</span>(<span class="st">"climat_condition"</span>),</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">grp_var =</span> <span class="st">"genotype"</span>,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">control_conditions =</span> <span class="fu">c</span>(<span class="st">"WW_OT"</span>),</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">biologist_stats =</span> T,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">strip_normale =</span> F,</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">outlier_show =</span> F,</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">label_outlier =</span> <span class="st">"plant_num"</span>,</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">show_plot =</span> T,</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">hex_pallet =</span> climate_pallet,</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">Ylab_i =</span> <span class="fu">paste0</span>(<span class="st">"Total evapotranspiration </span><span class="sc">\n</span><span class="st"> per leaf area (gH2O/cm¬≤)"</span>)</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>px_H2<span class="ot">&lt;-</span>px_H2[[<span class="st">"plot"</span>]]<span class="sc">+</span><span class="fu">labs</span>(<span class="at">color=</span><span class="st">"Treatment"</span>,<span class="at">fill=</span><span class="st">"Treatment"</span>)<span class="sc">+</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>()</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>px_H1<span class="ot">=</span><span class="fu">stat_analyse</span>(<span class="at">data =</span>sum_evapo_end_and_physio_H1 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">genotype=</span><span class="fu">as.factor</span>(genotype)) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(plant_num<span class="sc">!=</span><span class="dv">2</span>), <span class="co"># leaf area is wrong (not well developed)</span></span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>                <span class="at">column_value =</span> <span class="st">"evapo_surface"</span>,</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">category_variables =</span> <span class="st">"genotype"</span>,</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>                <span class="at">control_conditions =</span> <span class="st">""</span>,</span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>                <span class="at">biologist_stats =</span> T,</span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>                <span class="at">strip_normale =</span> F,</span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>                <span class="at">outlier_show =</span> F,</span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>                <span class="at">label_outlier =</span> <span class="st">"plant_num"</span>,</span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>                <span class="at">show_plot =</span> T,</span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>                <span class="at">hex_pallet =</span> climate_pallet,</span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>                <span class="at">Ylab_i =</span> <span class="fu">paste0</span>(<span class="st">"Total evapotranspiration </span><span class="sc">\n</span><span class="st"> per leaf area (gH2O/cm¬≤)"</span>)</span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>px_H1<span class="ot">&lt;-</span>px_H1[[<span class="st">"plot"</span>]]<span class="sc">+</span><span class="fu">labs</span>(<span class="at">color=</span><span class="st">"Treatment"</span>,<span class="at">fill=</span><span class="st">"Treatment"</span>)<span class="sc">+</span></span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>()</span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a>combined_plot<span class="ot">&lt;-</span>(px_H1<span class="sc">+</span>px_H2) <span class="co">#+ plot_layout(guides = 'collect')</span></span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a><span class="co"># export figure</span></span>
<span id="cb23-46"><a href="#cb23-46" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="fu">paste0</span>(<span class="st">"report/water/plot/evapo_leaf.png"</span>)), <span class="at">width =</span> <span class="dv">18</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">units =</span> <span class="st">'cm'</span>, <span class="at">res =</span> <span class="dv">900</span>)</span>
<span id="cb23-47"><a href="#cb23-47" aria-hidden="true" tabindex="-1"></a>combined_plot</span>
<span id="cb23-48"><a href="#cb23-48" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>p_licor<span class="ot">=</span><span class="fu">stat_analyse</span>(<span class="at">data =</span><span class="fu">read.csv2</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/physio/global_physio.csv"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>                     dplyr<span class="sc">::</span><span class="fu">select</span>(plant_num,condition,genotype,Trmmol) <span class="sc">%&gt;%</span> </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">mutate</span>(<span class="at">water_condition=</span><span class="fu">str_sub</span>(condition, <span class="dv">5</span>, <span class="dv">6</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">heat_condition=</span><span class="fu">str_sub</span>(condition, <span class="dv">8</span>, <span class="dv">9</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">climat_condition=</span><span class="fu">paste0</span>(water_condition, <span class="st">"_"</span>, heat_condition)) <span class="sc">%&gt;%</span> </span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">condition=</span><span class="fu">factor</span>(condition,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">"Sto_WW_OT"</span>,<span class="st">"Sto_WS_OT"</span>,<span class="st">"Sto_WW_HS"</span>,<span class="st">"Sto_WS_HS"</span>,<span class="st">"Wen_WW_OT"</span>,<span class="st">"Wen_WS_OT"</span>,<span class="st">"Wen_WW_HS"</span>,<span class="st">"Wen_WS_HS"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">climat_condition=</span><span class="fu">factor</span>(climat_condition,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">"WW_OT"</span>,<span class="st">"WS_OT"</span>,<span class="st">"WW_HS"</span>,<span class="st">"WS_HS"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">drop_na</span>(Trmmol),</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">column_value =</span> <span class="st">"Trmmol"</span>,</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">category_variables =</span> <span class="fu">c</span>(<span class="st">"climat_condition"</span>),</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">grp_var =</span> <span class="st">"genotype"</span>,</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">control_conditions =</span> <span class="fu">c</span>(<span class="st">"WW_OT"</span>),</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">biologist_stats =</span> T,</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">strip_normale =</span> F,</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">outlier_show =</span> F,</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">label_outlier =</span> <span class="st">"plant_num"</span>,</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">show_plot =</span> T,</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>                <span class="at">hex_pallet =</span> climate_pallet,</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>                <span class="at">Ylab_i =</span> <span class="fu">paste0</span>(<span class="st">"Transpiration rate (mmol H2O.m-2.s-1)"</span>)</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>p_licor<span class="ot">&lt;-</span>p_licor[[<span class="st">"plot"</span>]]<span class="sc">+</span><span class="fu">labs</span>(<span class="at">color=</span><span class="st">"Treatment"</span>,<span class="at">fill=</span><span class="st">"Treatment"</span>)<span class="sc">+</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>()</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a><span class="co"># export figure</span></span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="fu">paste0</span>(<span class="st">"report/water/plot/Transpiration_rate.png"</span>)), <span class="at">width =</span> <span class="dv">14</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">units =</span> <span class="st">'cm'</span>, <span class="at">res =</span> <span class="dv">900</span>)</span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>p_licor</span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a><span class="co"># for humidity close to the leaves ###################</span></span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>p_H2OS<span class="ot">=</span><span class="fu">stat_analyse</span>(<span class="at">data =</span><span class="fu">read.csv2</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/physio/global_physio.csv"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a>                     dplyr<span class="sc">::</span><span class="fu">select</span>(plant_num,condition,genotype,H2OS) <span class="sc">%&gt;%</span> </span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">mutate</span>(<span class="at">water_condition=</span><span class="fu">str_sub</span>(condition, <span class="dv">5</span>, <span class="dv">6</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">heat_condition=</span><span class="fu">str_sub</span>(condition, <span class="dv">8</span>, <span class="dv">9</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">climat_condition=</span><span class="fu">paste0</span>(water_condition, <span class="st">"_"</span>, heat_condition)) <span class="sc">%&gt;%</span> </span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">condition=</span><span class="fu">factor</span>(condition,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">"Sto_WW_OT"</span>,<span class="st">"Sto_WS_OT"</span>,<span class="st">"Sto_WW_HS"</span>,<span class="st">"Sto_WS_HS"</span>,<span class="st">"Wen_WW_OT"</span>,<span class="st">"Wen_WS_OT"</span>,<span class="st">"Wen_WW_HS"</span>,<span class="st">"Wen_WS_HS"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">climat_condition=</span><span class="fu">factor</span>(climat_condition,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">"WW_OT"</span>,<span class="st">"WS_OT"</span>,<span class="st">"WW_HS"</span>,<span class="st">"WS_HS"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">drop_na</span>(H2OS),</span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a>                <span class="at">column_value =</span> <span class="st">"H2OS"</span>,</span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a>                <span class="at">category_variables =</span> <span class="fu">c</span>(<span class="st">"climat_condition"</span>),</span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a>                <span class="at">grp_var =</span> <span class="st">"genotype"</span>,</span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a>                <span class="at">control_conditions =</span> <span class="fu">c</span>(<span class="st">"WW_OT"</span>),</span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a>                <span class="at">biologist_stats =</span> T,</span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a>                <span class="at">strip_normale =</span> F,</span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a>                <span class="at">outlier_show =</span> F,</span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a>                <span class="at">label_outlier =</span> <span class="st">"plant_num"</span>,</span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a>                <span class="at">show_plot =</span> T,</span>
<span id="cb24-53"><a href="#cb24-53" aria-hidden="true" tabindex="-1"></a>                <span class="at">hex_pallet =</span> climate_pallet,</span>
<span id="cb24-54"><a href="#cb24-54" aria-hidden="true" tabindex="-1"></a>                <span class="at">Ylab_i =</span> <span class="fu">paste0</span>(<span class="st">"Moisture on leaf surface (%)"</span>)</span>
<span id="cb24-55"><a href="#cb24-55" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb24-56"><a href="#cb24-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-57"><a href="#cb24-57" aria-hidden="true" tabindex="-1"></a>p_H2OS<span class="ot">&lt;-</span>p_H2OS[[<span class="st">"plot"</span>]]<span class="sc">+</span><span class="fu">labs</span>(<span class="at">color=</span><span class="st">"Treatment"</span>,<span class="at">fill=</span><span class="st">"Treatment"</span>)<span class="sc">+</span></span>
<span id="cb24-58"><a href="#cb24-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb24-59"><a href="#cb24-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb24-60"><a href="#cb24-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb24-61"><a href="#cb24-61" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb24-62"><a href="#cb24-62" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>()</span>
<span id="cb24-63"><a href="#cb24-63" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb24-64"><a href="#cb24-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-65"><a href="#cb24-65" aria-hidden="true" tabindex="-1"></a><span class="co"># for temperature of the leaves ###################</span></span>
<span id="cb24-66"><a href="#cb24-66" aria-hidden="true" tabindex="-1"></a>p_Tleaf<span class="ot">=</span><span class="fu">stat_analyse</span>(<span class="at">data =</span><span class="fu">read.csv2</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/physio/global_physio.csv"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb24-67"><a href="#cb24-67" aria-hidden="true" tabindex="-1"></a>                     dplyr<span class="sc">::</span><span class="fu">select</span>(plant_num,condition,genotype,Tleaf) <span class="sc">%&gt;%</span> </span>
<span id="cb24-68"><a href="#cb24-68" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">mutate</span>(<span class="at">water_condition=</span><span class="fu">str_sub</span>(condition, <span class="dv">5</span>, <span class="dv">6</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb24-69"><a href="#cb24-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">heat_condition=</span><span class="fu">str_sub</span>(condition, <span class="dv">8</span>, <span class="dv">9</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb24-70"><a href="#cb24-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">climat_condition=</span><span class="fu">paste0</span>(water_condition, <span class="st">"_"</span>, heat_condition)) <span class="sc">%&gt;%</span> </span>
<span id="cb24-71"><a href="#cb24-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">condition=</span><span class="fu">factor</span>(condition,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">"Sto_WW_OT"</span>,<span class="st">"Sto_WS_OT"</span>,<span class="st">"Sto_WW_HS"</span>,<span class="st">"Sto_WS_HS"</span>,<span class="st">"Wen_WW_OT"</span>,<span class="st">"Wen_WS_OT"</span>,<span class="st">"Wen_WW_HS"</span>,<span class="st">"Wen_WS_HS"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb24-72"><a href="#cb24-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">climat_condition=</span><span class="fu">factor</span>(climat_condition,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">"WW_OT"</span>,<span class="st">"WS_OT"</span>,<span class="st">"WW_HS"</span>,<span class="st">"WS_HS"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb24-73"><a href="#cb24-73" aria-hidden="true" tabindex="-1"></a>    <span class="fu">drop_na</span>(Tleaf),</span>
<span id="cb24-74"><a href="#cb24-74" aria-hidden="true" tabindex="-1"></a>                <span class="at">column_value =</span> <span class="st">"Tleaf"</span>,</span>
<span id="cb24-75"><a href="#cb24-75" aria-hidden="true" tabindex="-1"></a>                <span class="at">category_variables =</span> <span class="fu">c</span>(<span class="st">"climat_condition"</span>),</span>
<span id="cb24-76"><a href="#cb24-76" aria-hidden="true" tabindex="-1"></a>                <span class="at">grp_var =</span> <span class="st">"genotype"</span>,</span>
<span id="cb24-77"><a href="#cb24-77" aria-hidden="true" tabindex="-1"></a>                <span class="at">control_conditions =</span> <span class="fu">c</span>(<span class="st">"WW_OT"</span>),</span>
<span id="cb24-78"><a href="#cb24-78" aria-hidden="true" tabindex="-1"></a>                <span class="at">biologist_stats =</span> T,</span>
<span id="cb24-79"><a href="#cb24-79" aria-hidden="true" tabindex="-1"></a>                <span class="at">strip_normale =</span> F,</span>
<span id="cb24-80"><a href="#cb24-80" aria-hidden="true" tabindex="-1"></a>                <span class="at">outlier_show =</span> F,</span>
<span id="cb24-81"><a href="#cb24-81" aria-hidden="true" tabindex="-1"></a>                <span class="at">label_outlier =</span> <span class="st">"plant_num"</span>,</span>
<span id="cb24-82"><a href="#cb24-82" aria-hidden="true" tabindex="-1"></a>                <span class="at">show_plot =</span> T,</span>
<span id="cb24-83"><a href="#cb24-83" aria-hidden="true" tabindex="-1"></a>                <span class="at">hex_pallet =</span> climate_pallet,</span>
<span id="cb24-84"><a href="#cb24-84" aria-hidden="true" tabindex="-1"></a>                <span class="at">Ylab_i =</span> <span class="fu">paste0</span>(<span class="st">"Leaf surface temperature (¬∞C)"</span>)</span>
<span id="cb24-85"><a href="#cb24-85" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb24-86"><a href="#cb24-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-87"><a href="#cb24-87" aria-hidden="true" tabindex="-1"></a>p_Tleaf<span class="ot">&lt;-</span>p_Tleaf[[<span class="st">"plot"</span>]]<span class="sc">+</span><span class="fu">labs</span>(<span class="at">color=</span><span class="st">"Treatment"</span>,<span class="at">fill=</span><span class="st">"Treatment"</span>)<span class="sc">+</span></span>
<span id="cb24-88"><a href="#cb24-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb24-89"><a href="#cb24-89" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb24-90"><a href="#cb24-90" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb24-91"><a href="#cb24-91" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb24-92"><a href="#cb24-92" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>()</span>
<span id="cb24-93"><a href="#cb24-93" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb24-94"><a href="#cb24-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-95"><a href="#cb24-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-96"><a href="#cb24-96" aria-hidden="true" tabindex="-1"></a><span class="co"># for stomatac conductance of the leaves ###################</span></span>
<span id="cb24-97"><a href="#cb24-97" aria-hidden="true" tabindex="-1"></a>p_Gs<span class="ot">=</span><span class="fu">stat_analyse</span>(<span class="at">data =</span><span class="fu">read.csv2</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/physio/global_physio.csv"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb24-98"><a href="#cb24-98" aria-hidden="true" tabindex="-1"></a>                     dplyr<span class="sc">::</span><span class="fu">select</span>(plant_num,condition,genotype,Cond) <span class="sc">%&gt;%</span> </span>
<span id="cb24-99"><a href="#cb24-99" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">mutate</span>(<span class="at">water_condition=</span><span class="fu">str_sub</span>(condition, <span class="dv">5</span>, <span class="dv">6</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb24-100"><a href="#cb24-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">heat_condition=</span><span class="fu">str_sub</span>(condition, <span class="dv">8</span>, <span class="dv">9</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb24-101"><a href="#cb24-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">climat_condition=</span><span class="fu">paste0</span>(water_condition, <span class="st">"_"</span>, heat_condition)) <span class="sc">%&gt;%</span> </span>
<span id="cb24-102"><a href="#cb24-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">condition=</span><span class="fu">factor</span>(condition,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">"Sto_WW_OT"</span>,<span class="st">"Sto_WS_OT"</span>,<span class="st">"Sto_WW_HS"</span>,<span class="st">"Sto_WS_HS"</span>,<span class="st">"Wen_WW_OT"</span>,<span class="st">"Wen_WS_OT"</span>,<span class="st">"Wen_WW_HS"</span>,<span class="st">"Wen_WS_HS"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb24-103"><a href="#cb24-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">climat_condition=</span><span class="fu">factor</span>(climat_condition,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">"WW_OT"</span>,<span class="st">"WS_OT"</span>,<span class="st">"WW_HS"</span>,<span class="st">"WS_HS"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb24-104"><a href="#cb24-104" aria-hidden="true" tabindex="-1"></a>    <span class="fu">drop_na</span>(Cond),</span>
<span id="cb24-105"><a href="#cb24-105" aria-hidden="true" tabindex="-1"></a>                <span class="at">column_value =</span> <span class="st">"Cond"</span>,</span>
<span id="cb24-106"><a href="#cb24-106" aria-hidden="true" tabindex="-1"></a>                <span class="at">category_variables =</span> <span class="fu">c</span>(<span class="st">"climat_condition"</span>),</span>
<span id="cb24-107"><a href="#cb24-107" aria-hidden="true" tabindex="-1"></a>                <span class="at">grp_var =</span> <span class="st">"genotype"</span>,</span>
<span id="cb24-108"><a href="#cb24-108" aria-hidden="true" tabindex="-1"></a>                <span class="at">control_conditions =</span> <span class="fu">c</span>(<span class="st">"WW_OT"</span>),</span>
<span id="cb24-109"><a href="#cb24-109" aria-hidden="true" tabindex="-1"></a>                <span class="at">biologist_stats =</span> T,</span>
<span id="cb24-110"><a href="#cb24-110" aria-hidden="true" tabindex="-1"></a>                <span class="at">strip_normale =</span> F,</span>
<span id="cb24-111"><a href="#cb24-111" aria-hidden="true" tabindex="-1"></a>                <span class="at">outlier_show =</span> F,</span>
<span id="cb24-112"><a href="#cb24-112" aria-hidden="true" tabindex="-1"></a>                <span class="at">label_outlier =</span> <span class="st">"plant_num"</span>,</span>
<span id="cb24-113"><a href="#cb24-113" aria-hidden="true" tabindex="-1"></a>                <span class="at">show_plot =</span> T,</span>
<span id="cb24-114"><a href="#cb24-114" aria-hidden="true" tabindex="-1"></a>                <span class="at">hex_pallet =</span> climate_pallet,</span>
<span id="cb24-115"><a href="#cb24-115" aria-hidden="true" tabindex="-1"></a>                <span class="at">Ylab_i =</span> <span class="fu">expression</span>(G[s] <span class="sc">~</span> <span class="st">"("</span> <span class="sc">*</span> mol <span class="sc">~</span> H[<span class="dv">2</span>]<span class="sc">*</span>O <span class="sc">~</span> m<span class="sc">^</span>{<span class="sc">-</span><span class="dv">2</span>} <span class="sc">~</span> s<span class="sc">^</span>{<span class="sc">-</span><span class="dv">1</span>} <span class="sc">*</span> <span class="st">")"</span>),</span>
<span id="cb24-116"><a href="#cb24-116" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb24-117"><a href="#cb24-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-118"><a href="#cb24-118" aria-hidden="true" tabindex="-1"></a>p_Gs<span class="ot">&lt;-</span>p_Gs[[<span class="st">"plot"</span>]]<span class="sc">+</span><span class="fu">labs</span>(<span class="at">color=</span><span class="st">"Treatment"</span>,<span class="at">fill=</span><span class="st">"Treatment"</span>)<span class="sc">+</span></span>
<span id="cb24-119"><a href="#cb24-119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb24-120"><a href="#cb24-120" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb24-121"><a href="#cb24-121" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb24-122"><a href="#cb24-122" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb24-123"><a href="#cb24-123" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>()</span>
<span id="cb24-124"><a href="#cb24-124" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb24-125"><a href="#cb24-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-126"><a href="#cb24-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-127"><a href="#cb24-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-128"><a href="#cb24-128" aria-hidden="true" tabindex="-1"></a><span class="co"># export figure</span></span>
<span id="cb24-129"><a href="#cb24-129" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="fu">paste0</span>(<span class="st">"report/water/plot/Transpiration_rate.png"</span>)), <span class="at">width =</span> <span class="dv">14</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">units =</span> <span class="st">'cm'</span>, <span class="at">res =</span> <span class="dv">900</span>)</span>
<span id="cb24-130"><a href="#cb24-130" aria-hidden="true" tabindex="-1"></a>p_licor</span>
<span id="cb24-131"><a href="#cb24-131" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb24-132"><a href="#cb24-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-133"><a href="#cb24-133" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="fu">paste0</span>(<span class="st">"report/water/plot/H2OS.png"</span>)), <span class="at">width =</span> <span class="dv">14</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">units =</span> <span class="st">'cm'</span>, <span class="at">res =</span> <span class="dv">900</span>)</span>
<span id="cb24-134"><a href="#cb24-134" aria-hidden="true" tabindex="-1"></a>p_H2OS</span>
<span id="cb24-135"><a href="#cb24-135" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb24-136"><a href="#cb24-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-137"><a href="#cb24-137" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="fu">paste0</span>(<span class="st">"report/water/plot/Tleaf.png"</span>)), <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">units =</span> <span class="st">'cm'</span>, <span class="at">res =</span> <span class="dv">900</span>)</span>
<span id="cb24-138"><a href="#cb24-138" aria-hidden="true" tabindex="-1"></a>p_Tleaf</span>
<span id="cb24-139"><a href="#cb24-139" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb24-140"><a href="#cb24-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-141"><a href="#cb24-141" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="fu">paste0</span>(<span class="st">"report/water/plot/Gs.png"</span>)), <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">units =</span> <span class="st">'cm'</span>, <span class="at">res =</span> <span class="dv">900</span>)</span>
<span id="cb24-142"><a href="#cb24-142" aria-hidden="true" tabindex="-1"></a>p_Gs</span>
<span id="cb24-143"><a href="#cb24-143" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><a href="plot/Transpiration_ratE.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13"><img src="plot/Transpiration_ratE.png" class="img-fluid"></a></p>
</section>
<section id="evaporation-one-days-befor-second-harvest" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="evaporation-one-days-befor-second-harvest"><span class="header-section-number">3.6</span> Evaporation one days befor second harvest</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calcul</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>df_evapo_biomass<span class="ot">&lt;-</span><span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/water/weighing_watering_output/df_evapo3.csv"</span>))[<span class="sc">-</span><span class="dv">1</span>] <span class="sc">%&gt;%</span> </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(next_weight) <span class="sc">%&gt;%</span> </span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(resultdate<span class="sc">==</span><span class="st">"2021-10-11"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(taskid <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">28697</span>, <span class="dv">28699</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(leaf_area) <span class="sc">%&gt;%</span> </span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diff_resultdate_time_h=</span>diff_resultdate_time<span class="sc">/</span><span class="dv">60</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">leaf_area_m=</span>leaf_area<span class="sc">/</span><span class="dv">10000</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">transpiPlante_g_h=</span>evapotranspiration<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>diff_resultdate_time<span class="sc">/</span><span class="dv">60</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">TR_g_m2_s=</span>transpiPlante_g_h<span class="sc">/</span>(leaf_area_m<span class="sc">*</span><span class="dv">3600</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">TR_mmol_m2_s=</span>TR_g_m2_s<span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">3</span><span class="sc">/</span><span class="fl">18.015</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(plant_num, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="co"># export</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(df_evapo_biomass, here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/water/weighing_watering_output/transpiration_rate_20231011.csv"</span>))</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a><span class="co"># creation table</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>df_evapo_biomass_mean <span class="ot">=</span> df_evapo_biomass <span class="sc">%&gt;%</span> </span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">select</span>(condition, transpiPlante_g_h, leaf_area,diff_resultdate_time,TR_mmol_m2_s) <span class="sc">%&gt;%</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(condition) <span class="sc">%&gt;%</span> </span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="fu">across</span>(transpiPlante_g_h <span class="sc">:</span> TR_mmol_m2_s, <span class="fu">list</span>(mean,sd), <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>df_evapo_biomass_mean <span class="sc">%&gt;%</span> </span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a><span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Evapotranspiration by surface of leaf between two measure (Mean)"</span>, <span class="at">col.names=</span><span class="fu">c</span>(<span class="st">"Condition"</span>, <span class="st">"Plant transpiration (g/h)"</span>, <span class="st">"sd"</span>,<span class="st">"Leaf area (cm¬≤)"</span>, <span class="st">"sd"</span>,<span class="st">"time between two weighings (min)"</span>,<span class="st">"sd"</span>, <span class="st">"Transpiration rate (mmol m-2 s-1"</span>, <span class="st">"sd"</span>), <span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a><span class="fu">kable_paper</span>(<span class="at">full_width =</span> F) <span class="sc">%&gt;%</span> </span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">8</span>, <span class="at">color =</span> <span class="st">"white"</span>,<span class="at">background =</span> <span class="fu">spec_color</span>(df_evapo_biomass_mean <span class="sc">%&gt;%</span>  <span class="fu">pull</span>(TR_mmol_m2_s_1), <span class="at">end =</span> <span class="fl">0.7</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-paper caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Evapotranspiration by surface of leaf between two measure (Mean)</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Condition</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Plant transpiration (g/h)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sd</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Leaf area (cm¬≤)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sd</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">time between two weighings (min)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sd</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Transpiration rate (mmol m-2 s-1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Sto_WS_HS</td>
<td style="text-align: right;">0.21</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">31.19</td>
<td style="text-align: right;">8.06</td>
<td style="text-align: right;">456.00</td>
<td style="text-align: right;">5.61</td>
<td style="text-align: right; color: white !important; background-color: rgba(72, 24, 106, 255) !important;">1.17</td>
<td style="text-align: right;">0.53</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sto_WS_OT</td>
<td style="text-align: right;">0.41</td>
<td style="text-align: right;">0.14</td>
<td style="text-align: right;">65.14</td>
<td style="text-align: right;">9.75</td>
<td style="text-align: right;">443.08</td>
<td style="text-align: right;">1.56</td>
<td style="text-align: right; color: white !important; background-color: rgba(70, 11, 94, 255) !important;">1.00</td>
<td style="text-align: right;">0.38</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sto_WW_HS</td>
<td style="text-align: right;">4.55</td>
<td style="text-align: right;">0.55</td>
<td style="text-align: right;">165.99</td>
<td style="text-align: right;">29.45</td>
<td style="text-align: right;">454.13</td>
<td style="text-align: right;">6.07</td>
<td style="text-align: right; color: white !important; background-color: rgba(67, 191, 113, 255) !important;">4.31</td>
<td style="text-align: right;">0.61</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sto_WW_OT</td>
<td style="text-align: right;">4.21</td>
<td style="text-align: right;">0.59</td>
<td style="text-align: right;">187.86</td>
<td style="text-align: right;">36.74</td>
<td style="text-align: right;">442.77</td>
<td style="text-align: right;">1.95</td>
<td style="text-align: right; color: white !important; background-color: rgba(31, 153, 138, 255) !important;">3.51</td>
<td style="text-align: right;">0.44</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Wen_WS_HS</td>
<td style="text-align: right;">0.28</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">42.83</td>
<td style="text-align: right;">8.12</td>
<td style="text-align: right;">455.67</td>
<td style="text-align: right;">5.38</td>
<td style="text-align: right; color: white !important; background-color: rgba(71, 16, 99, 255) !important;">1.06</td>
<td style="text-align: right;">0.25</td>
</tr>
<tr class="even">
<td style="text-align: left;">Wen_WS_OT</td>
<td style="text-align: right;">0.41</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">75.06</td>
<td style="text-align: right;">11.35</td>
<td style="text-align: right;">442.90</td>
<td style="text-align: right;">1.78</td>
<td style="text-align: right; color: white !important; background-color: rgba(68, 1, 84, 255) !important;">0.86</td>
<td style="text-align: right;">0.23</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Wen_WW_HS</td>
<td style="text-align: right;">4.94</td>
<td style="text-align: right;">0.58</td>
<td style="text-align: right;">194.14</td>
<td style="text-align: right;">44.93</td>
<td style="text-align: right;">453.25</td>
<td style="text-align: right;">7.09</td>
<td style="text-align: right; color: white !important; background-color: rgba(51, 182, 121, 255) !important;">4.12</td>
<td style="text-align: right;">0.95</td>
</tr>
<tr class="even">
<td style="text-align: left;">Wen_WW_OT</td>
<td style="text-align: right;">4.33</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">228.64</td>
<td style="text-align: right;">46.92</td>
<td style="text-align: right;">443.09</td>
<td style="text-align: right;">2.07</td>
<td style="text-align: right; color: white !important; background-color: rgba(38, 130, 142, 255) !important;">3.03</td>
<td style="text-align: right;">0.67</td>
</tr>
</tbody>
</table>


</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>px<span class="ot">=</span><span class="fu">stat_analyse</span>(<span class="at">data =</span>df_evapo_biomass <span class="sc">%&gt;%</span> </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>                  <span class="co">#mutate(heat_condition=str_sub(condition, 8, 9)) %&gt;% </span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">climat_condition=</span><span class="fu">paste0</span>(water_condition, <span class="st">"_"</span>, heat_condition)) <span class="sc">%&gt;%</span> </span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#mutate(condition=factor(condition,levels=c("Sto_WW_OT","Sto_WS_OT","Sto_WW_HS","Sto_WS_HS","Wen_WW_OT","Wen_WS_OT","Wen_WW_HS","Wen_WS_HS"))) %&gt;% </span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">climat_condition=</span><span class="fu">factor</span>(climat_condition,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">"WW_OT"</span>,<span class="st">"WS_OT"</span>,<span class="st">"WW_HS"</span>,<span class="st">"WS_HS"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">drop_na</span>(TR_mmol_m2_s),</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">column_value =</span> <span class="st">"TR_mmol_m2_s"</span>,</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">category_variables =</span> <span class="fu">c</span>(<span class="st">"climat_condition"</span>),</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">grp_var =</span> <span class="st">"genotype"</span>,</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">control_conditions =</span> <span class="fu">c</span>(<span class="st">"WW_OT"</span>),</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">biologist_stats =</span> T,</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">strip_normale =</span> F,</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">outlier_show =</span> F,</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">label_outlier =</span> <span class="st">"plant_num"</span>,</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">show_plot =</span> T,</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">hex_pallet =</span> climate_pallet,</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">Ylab_i =</span> <span class="fu">paste0</span>(<span class="st">"Evapotranspiration during licore measure </span><span class="sc">\n</span><span class="st"> per leaf area (mmol.m-2.s-1)"</span>)</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>px<span class="ot">&lt;-</span>px[[<span class="st">"plot"</span>]]<span class="sc">+</span><span class="fu">labs</span>(<span class="at">color=</span><span class="st">"Treatment"</span>,<span class="at">fill=</span><span class="st">"Treatment"</span>)<span class="sc">+</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>()</span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a><span class="co"># export figure</span></span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="fu">paste0</span>(<span class="st">"report/water/plot/Transpiration_rate_20211011.png"</span>)), <span class="at">width =</span> <span class="dv">14</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">units =</span> <span class="st">'cm'</span>, <span class="at">res =</span> <span class="dv">900</span>)</span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>px</span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><a href="plot/Transpiration_rate_20211011.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14"><img src="plot/Transpiration_rate_20211011.png" class="img-fluid"></a></p>
<details>
<summary style="color: #007bff;">
Bonnus: Draft of some statistics
</summary>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>test<span class="ot">=</span>df_compile_sRWU <span class="sc">%&gt;%</span> </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(sRWU) <span class="sc">%&gt;%</span> </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#filter(climat_condition=="WW_OT") %&gt;% </span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t_test</span>(sRWU <span class="sc">~</span> condition,<span class="at">p.adjust.method =</span> <span class="st">"BH"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_significance</span>()</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>test<span class="ot">=</span>df_compile <span class="sc">%&gt;%</span> </span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(WUE) <span class="sc">%&gt;%</span> </span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#filter(climat_condition=="WW_OT") %&gt;% </span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t_test</span>(WUE <span class="sc">~</span> condition,<span class="at">p.adjust.method =</span> <span class="st">"BH"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_significance</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>df_physio_s<span class="ot">=</span>df_compile <span class="sc">%&gt;%</span> </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(WUE) <span class="sc">%&gt;%</span> </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#filter(genotype=="Stocata") %&gt;% </span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#filter(condition%in% c("Sto_WW_HS","Wen_WW_HS")) %&gt;% </span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(condition) <span class="sc">%&gt;%</span> </span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">Mean=</span><span class="fu">mean</span>(WUE))</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>(df_physio_s<span class="sc">$</span>Mean[<span class="dv">4</span>]<span class="sc">-</span>df_physio_s<span class="sc">$</span>Mean[<span class="dv">8</span>])<span class="sc">/</span>df_physio_s<span class="sc">$</span>Mean[<span class="dv">8</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</details>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../report/intro/1_experimental_design_climat.html" class="pagination-link" aria-label="Experimental design and climate condition">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Experimental design and climate condition</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../report/physio/2_RUE.html" class="pagination-link" aria-label="Calcul of Radiation Use Efficiency">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Calcul of Radiation Use Efficiency</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
      <i class="bi bi-badge-cc-fill" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="https://cmaslard.xyz/">
<p>Corentin Maslard 2024</p>
</a>
  </li>  
</ul>
    </div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="mailto:maslard.corentin@gmail.com">
<p><iconify-icon role="img" inline="" icon="fa6-solid:envelope" aria-label="Icon envelope from fa6-solid Iconify.design set." title="Icon envelope from fa6-solid Iconify.design set."></iconify-icon></p>
</a>
  </li>  
    <li class="nav-item">
 
  </li>  
    <li class="nav-item compact">
    <a class="nav-link active" href="https://github.com/cmaslard/phd_soybean_2021_2024/" aria-current="page">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="https://www.linkedin.com/in/corentin-maslard">
<p><iconify-icon role="img" inline="" icon="fa6-brands:linkedin" aria-label="Icon linkedin from fa6-brands Iconify.design set." title="Icon linkedin from fa6-brands Iconify.design set."></iconify-icon></p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="https://x.com/cmaslard">
<p><iconify-icon role="img" inline="" icon="fa6-brands:square-x-twitter" aria-label="Icon square-x-twitter from fa6-brands Iconify.design set." title="Icon square-x-twitter from fa6-brands Iconify.design set."></iconify-icon></p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="https://orcid.org/0000-0002-6951-1963">
<p><iconify-icon role="img" inline="" icon="fa6-brands:orcid" aria-label="Icon orcid from fa6-brands Iconify.design set." title="Icon orcid from fa6-brands Iconify.design set."></iconify-icon></p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="https://www.researchgate.net/profile/Corentin-Maslard">
<p><iconify-icon role="img" inline="" icon="fa6-brands:researchgate" aria-label="Icon researchgate from fa6-brands Iconify.design set." title="Icon researchgate from fa6-brands Iconify.design set."></iconify-icon></p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="https://scholar.google.com/citations?user=TsztyiMAAAAJ&amp;hl" target="blank">
<p><iconify-icon role="img" inline="" icon="academicons:google-scholar" aria-label="Icon google-scholar from academicons Iconify.design set." title="Icon google-scholar from academicons Iconify.design set."></iconify-icon></p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="https://cv.hal.science/corentinmaslard">
<p><iconify-icon role="img" inline="" icon="academicons:hal" aria-label="Icon hal from academicons Iconify.design set." title="Icon hal from academicons Iconify.design set."></iconify-icon></p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="https://docs.google.com/document/d/1oCgrdjnAJuVjgocx3F2kmlbJxlqa6uWrSgqm5fWRhpA/edit?usp=sharing">
<p><iconify-icon role="img" inline="" icon="pepicons-pop:cv" aria-label="Icon cv from pepicons-pop Iconify.design set." title="Icon cv from pepicons-pop Iconify.design set."></iconify-icon></p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="https://1drv.ms/b/s!Aq9vs33-G0z9wfsFkiGfdJDcvK2Ouw?e=uW3vYb">
<p>Draft Thesis Manuscript</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="https://corentin-maslard.shinyapps.io/shiny_XP1_Corentin_Maslard/">
<p>R-shiny</p>
</a>
  </li>  
</ul>
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/cmaslard/phd_soybean_2021_2024/blob/main/report/water/2_water_during_the_experiment.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li><li><a href="https://github.com/cmaslard/phd_soybean_2021_2024/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p><span class="faux-block">Made with <iconify-icon icon="line-md:heart-twotone"></iconify-icon>, <iconify-icon icon="line-md:coffee-twotone-loop"></iconify-icon>, <iconify-icon role="img" inline="" icon="fa6-brands:r-project" aria-label="Icon r-project from fa6-brands Iconify.design set." title="Icon r-project from fa6-brands Iconify.design set."></iconify-icon> and <a href="https://quarto.org/">Quarto</a></span> | <span class="faux-block"><a href="https://github.com/cmaslard/cmaslard.github.io">View the source at <iconify-icon role="img" inline="" icon="fa6-brands:github" aria-label="Icon github from fa6-brands Iconify.design set." title="Icon github from fa6-brands Iconify.design set."></iconify-icon> GitHub</a></span></p>
</div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"loop":false,"closeEffect":"fade","openEffect":"fade","descPosition":"right","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>